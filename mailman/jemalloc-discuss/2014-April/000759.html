<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> keeping memory usage at certain limit
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20keeping%20memory%20usage%20at%20certain%20limit&In-Reply-To=%3C535E36A0.5080805%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000758.html">
   <LINK REL="Next"  HREF="000760.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>keeping memory usage at certain limit</H1>
    <B>Antony Dovgal</B> 
    <A HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20keeping%20memory%20usage%20at%20certain%20limit&In-Reply-To=%3C535E36A0.5080805%40gmail.com%3E"
       TITLE="keeping memory usage at certain limit">antony.dovgal at gmail.com
       </A><BR>
    <I>Mon Apr 28 04:08:16 PDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000758.html">mremap with modern Linux kernel
</A></li>
        <LI>Next message: <A HREF="000760.html">keeping memory usage at certain limit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#759">[ date ]</a>
              <a href="thread.html#759">[ thread ]</a>
              <a href="subject.html#759">[ subject ]</a>
              <a href="author.html#759">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,

I'm currently working on a daemon that processes a lot of data and has to store the most recent of it.
Unfortunately, memory is allocated and freed in small blocks and in totally random (for the allocator) manner.
I use &quot;stats.allocated&quot; to measure how much memory is currently in use, delete the oldest data when the memory limit is reached and purge thread caches with &quot;arena.N.purge&quot; from time to time.

The problem is that keeping stat.allocated on a certain level doesn't keep the process from growing until it's killed by OOM-killer.
I suspect that this is caused by memory fragmentation issues, though I've no idea how to prove it (or at least all my ideas involve complex stats and are quite inefficient).

So my main questions are:
is there any way to see how much memory is currently being (under)used because of fragmentation in Jemalloc?
is there a way to prevent it or force some garbage collection?

Thanks in advance.

-- 
Wbr,
Antony Dovgal
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000758.html">mremap with modern Linux kernel
</A></li>
	<LI>Next message: <A HREF="000760.html">keeping memory usage at certain limit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#759">[ date ]</a>
              <a href="thread.html#759">[ thread ]</a>
              <a href="subject.html#759">[ subject ]</a>
              <a href="author.html#759">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">More information about the jemalloc-discuss
mailing list</a><br>
</body></html>
