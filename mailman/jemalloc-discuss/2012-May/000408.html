<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> More aggressive page purging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20More%20aggressive%20page%20purging&In-Reply-To=%3C20120510184614.GA30292%40glandium.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000407.html">
   <LINK REL="Next"  HREF="000410.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>More aggressive page purging</H1>
    <B>Mike Hommey</B> 
    <A HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20More%20aggressive%20page%20purging&In-Reply-To=%3C20120510184614.GA30292%40glandium.org%3E"
       TITLE="More aggressive page purging">mh+jemalloc at glandium.org
       </A><BR>
    <I>Thu May 10 11:46:14 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000407.html">More aggressive page purging
</A></li>
        <LI>Next message: <A HREF="000410.html">More aggressive page purging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#408">[ date ]</a>
              <a href="thread.html#408">[ thread ]</a>
              <a href="subject.html#408">[ subject ]</a>
              <a href="author.html#408">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, May 10, 2012 at 11:19:07AM -0700, Jason Evans wrote:
&gt;<i> I don't see the point in double purge on OS X (or FreeBSD, which
</I>&gt;<i> behaves similarly), assuming that the kernel actually does the right
</I>&gt;<i> think under memory pressure.  All it does is make 'top' output easier
</I>&gt;<i> to interpret,  yet jemalloc provides adequate statistics to accurately
</I>&gt;<i> assess the application's actual active memory footprint (and Firefox
</I>&gt;<i> even exposes those statistics, right?).  IMO MADV_FREE is a feature,
</I>&gt;<i> not a bug.  Indeed, on Linux, MADV_DONTNEED is a performance headache
</I>&gt;<i> that we've had to work around in various ways at Facebook, with mixed
</I>&gt;<i> success.
</I>&gt;<i> 
</I>&gt;<i> My memory of Windows virtual memory semantics is fuzzy, but my
</I>&gt;<i> recollection is that the decommit support we put into jemalloc for
</I>&gt;<i> Firefox was motivated primarily by inadequate operating system
</I>&gt;<i> statistics for Windows XP that confused our understanding of actual
</I>&gt;<i> memory usage.  The VirtualAlloc() documentation indicates that
</I>&gt;<i> MEM_RESET has the same semantics as MADV_FREE, which is (again IMO) a
</I>&gt;<i> good thing.
</I>
It has the same semantics, which is why I'm suggesting both could use
the same thing.

&gt;<i> In summary, I don't think there's a problem here to fix.  Am I missing
</I>&gt;<i> something?
</I>
We could use RSS - number of madvised pages, for sure, but that doesn't
quite help with people looking at their task manager ans seeing memory
usage 1GB higher than what it actually is. (And it doesn't help to make
the numbers Firefox itself reports believable)

Mike

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000407.html">More aggressive page purging
</A></li>
	<LI>Next message: <A HREF="000410.html">More aggressive page purging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#408">[ date ]</a>
              <a href="thread.html#408">[ thread ]</a>
              <a href="subject.html#408">[ subject ]</a>
              <a href="author.html#408">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">More information about the jemalloc-discuss
mailing list</a><br>
</body></html>
