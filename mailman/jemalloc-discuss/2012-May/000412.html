<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> More aggressive page purging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20More%20aggressive%20page%20purging&In-Reply-To=%3CCAFWcpZ7Vwm9QDSxtKS9WNapTsuzGFfV6_RbAOkzV73HkemwMSg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000411.html">
   <LINK REL="Next"  HREF="000413.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>More aggressive page purging</H1>
    <B>Justin Lebar</B> 
    <A HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20More%20aggressive%20page%20purging&In-Reply-To=%3CCAFWcpZ7Vwm9QDSxtKS9WNapTsuzGFfV6_RbAOkzV73HkemwMSg%40mail.gmail.com%3E"
       TITLE="More aggressive page purging">justin.lebar at gmail.com
       </A><BR>
    <I>Fri May 11 18:26:55 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000411.html">More aggressive page purging
</A></li>
        <LI>Next message: <A HREF="000413.html">More aggressive page purging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#412">[ date ]</a>
              <a href="thread.html#412">[ thread ]</a>
              <a href="subject.html#412">[ subject ]</a>
              <a href="author.html#412">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On May 11, 2012 5:16 PM, &quot;Jason Evans&quot; &lt;<A HREF="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">jasone at canonware.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> On May 10, 2012, at 11:55 AM, Justin Lebar wrote:
</I>&gt;<i> &gt;&gt;&gt; In summary, I don't think there's a problem here to fix.  Am I missing
</I>&gt;<i> &gt;&gt;&gt; something?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; We could use RSS - number of madvised pages, for sure, but that doesn't
</I>&gt;<i> &gt;&gt; quite help with people looking at their task manager ans seeing memory
</I>&gt;<i> &gt;&gt; usage 1GB higher than what it actually is. (And it doesn't help to make
</I>&gt;<i> &gt;&gt; the numbers Firefox itself reports believable)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yeah, the perception problem (&quot;I looked at the task manager and
</I>&gt;<i> &gt; Firefox sux!&quot;) is a real one that, from MemShrink's perspective, we
</I>&gt;<i> &gt; need to solve.
</I>&gt;<i>
</I>&gt;<i> It's unfortunate that the operating systems don't expose statistics that
</I>provide clarity here.  I don't want to make aggressive purging default
behavior,

To be clear, what we do at moment is purge only right before we query the
OS for our RSS. In practice, this happens whenever we load about:memory or
run a telemetry ping, which happens every few (five?) minutes when the
browser is idle.

Its not ideal from the standpoint of a user looking at the task manager,
but at least our stats are correct.

I think we'd want the same behavior, purging only upon a malctl, rather
than automatically.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://jemalloc.net/mailman/jemalloc-discuss/attachments/20120511/eb50459f/attachment.html">http://jemalloc.net/mailman/jemalloc-discuss/attachments/20120511/eb50459f/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000411.html">More aggressive page purging
</A></li>
	<LI>Next message: <A HREF="000413.html">More aggressive page purging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#412">[ date ]</a>
              <a href="thread.html#412">[ thread ]</a>
              <a href="subject.html#412">[ subject ]</a>
              <a href="author.html#412">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">More information about the jemalloc-discuss
mailing list</a><br>
</body></html>
