<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> dead lock in forked child
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20dead%20lock%20in%20forked%20child&In-Reply-To=%3CCA%2BXzkVdAYsAHJOsTDmxM-80jTCJUCQhHijLan0CtiSXENwVWsA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000430.html">
   <LINK REL="Next"  HREF="000432.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>dead lock in forked child</H1>
    <B>Salvatore Sanfilippo</B> 
    <A HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20dead%20lock%20in%20forked%20child&In-Reply-To=%3CCA%2BXzkVdAYsAHJOsTDmxM-80jTCJUCQhHijLan0CtiSXENwVWsA%40mail.gmail.com%3E"
       TITLE="dead lock in forked child">antirez at gmail.com
       </A><BR>
    <I>Fri Jun  1 12:42:56 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000430.html">dead lock in forked child
</A></li>
        <LI>Next message: <A HREF="000432.html">patches for jemalloc 3.0.0 with mingw-w64 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#431">[ date ]</a>
              <a href="thread.html#431">[ thread ]</a>
              <a href="subject.html#431">[ subject ]</a>
              <a href="author.html#431">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jun 1, 2012 at 9:07 PM, Jason Evans &lt;<A HREF="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">jasone at canonware.com</A>&gt; wrote:
&gt;<i> It's likely that redis is hitting the bug that was fixed for jemalloc 3.0.0 by this change:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.canonware.com/cgi-bin/gitweb.cgi?p=jemalloc.git;a=commitdiff;h=4e2e3dd9cf19ed5991938a708a8b50611aa5bbf8">http://www.canonware.com/cgi-bin/gitweb.cgi?p=jemalloc.git;a=commitdiff;h=4e2e3dd9cf19ed5991938a708a8b50611aa5bbf8</A>
</I>&gt;<i>
</I>&gt;<i> jemalloc changed to a finer-grained locking model shortly before the 1.0.0 release, but the fork-related support didn't have the necessary changes to lock all relevant mutexes until this change.
</I>
Thank you, I'll make sure to upgrade to Jemalloc 3.0.0 for the stable
branch of Redis (already done into 2.6 / unstable).

I want to say thank you for Jemalloc, it solved our fragmentation
problems in an impressive way, basically after the jemalloc adoption
we stopped receiving fragmentation reports at all (excluding the false
positives about an RSS / sum_of_allocation that was high because the
instance was emptied after a peak memory usage. But we can now detect
this condition thanks to a new INFO field remembering the peak memory
usage).

Cheers,
Salvatore

-- 
Salvatore 'antirez' Sanfilippo
open source developer - VMware
<A HREF="http://invece.org">http://invece.org</A>

Beauty is more important in computing than anywhere else in technology
because software is so complicated. Beauty is the ultimate defence
against complexity.
&#160; &#160; &#160; &#160;&#8212; David Gelernter

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000430.html">dead lock in forked child
</A></li>
	<LI>Next message: <A HREF="000432.html">patches for jemalloc 3.0.0 with mingw-w64 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#431">[ date ]</a>
              <a href="thread.html#431">[ thread ]</a>
              <a href="subject.html#431">[ subject ]</a>
              <a href="author.html#431">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">More information about the jemalloc-discuss
mailing list</a><br>
</body></html>
