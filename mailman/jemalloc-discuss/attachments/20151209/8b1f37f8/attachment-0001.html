<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi,&nbsp;&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;facing&nbsp;a&nbsp;segfault&nbsp;when&nbsp;using&nbsp;Jemalloc,&nbsp;it&nbsp;happens&nbsp;with&nbsp;Jemalloc&nbsp;3.x&nbsp;and&nbsp;4.0.4.&nbsp;If&nbsp;I&nbsp;use&nbsp;the&nbsp;default&nbsp;system&nbsp;memory&nbsp;allocator&nbsp;(Linux)&nbsp;there&nbsp;is&nbsp;no&nbsp;issues&nbsp;(valgrind&nbsp;cannot&nbsp;find&nbsp;any&nbsp;corruption).&lt;br&gt;&lt;br&gt;&lt;/div&gt;Would&nbsp;you&nbsp;please&nbsp;advice&nbsp;any&nbsp;step&nbsp;to&nbsp;determinate&nbsp;if&nbsp;the&nbsp;problem&nbsp;it&#39;s&nbsp;on&nbsp;my&nbsp;code&nbsp;or&nbsp;on&nbsp;jemalloc&nbsp;it&nbsp;self&nbsp;?&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;---&lt;br&gt;&lt;jemalloc&gt;:&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/include/jemalloc/internal/arena.h:575:&nbsp;Failed&nbsp;assertion:&nbsp;&quot;pageind&nbsp;&gt;=&nbsp;map_bias&quot;&lt;br&gt;&lt;br&gt;Program&nbsp;received&nbsp;signal&nbsp;SIGABRT,&nbsp;Aborted.&lt;br&gt;[Switching&nbsp;to&nbsp;Thread&nbsp;0x7ffff51ff700&nbsp;(LWP&nbsp;4613)]&lt;br&gt;0x00007ffff7622267&nbsp;in&nbsp;__GI_raise&nbsp;(sig=sig@entry=6)&nbsp;at&nbsp;../sysdeps/unix/sysv/linux/raise.c:55&lt;br&gt;55   &nbsp;../sysdeps/unix/sysv/linux/raise.c:&nbsp;No&nbsp;such&nbsp;file&nbsp;or&nbsp;directory.&lt;br&gt;(gdb)&nbsp;bt&lt;br&gt;#0 &nbsp;0x00007ffff7622267&nbsp;in&nbsp;__GI_raise&nbsp;(sig=sig@entry=6)&nbsp;at&nbsp;../sysdeps/unix/sysv/linux/raise.c:55&lt;br&gt;#1 &nbsp;0x00007ffff7623eca&nbsp;in&nbsp;__GI_abort&nbsp;()&nbsp;at&nbsp;abort.c:89&lt;br&gt;#2 &nbsp;0x000000000042826e&nbsp;in&nbsp;je_arena_bitselm_get&nbsp;(chunk=&lt;optimized&nbsp;out&gt;,&nbsp;pageind=&lt;optimized&nbsp;out&gt;)&lt;br&gt;   &nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/include/jemalloc/internal/arena.h:576&lt;br&gt;#3 &nbsp;0x000000000042e1e0&nbsp;in&nbsp;je_arena_mapbitsp_get&nbsp;(pageind=0,&nbsp;chunk=0x7fffdc000000)&nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/include/jemalloc/internal/arena.h:642&lt;br&gt;#4 &nbsp;je_arena_mapbits_get&nbsp;(pageind=0,&nbsp;chunk=0x7fffdc000000)&nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/include/jemalloc/internal/arena.h:656&lt;br&gt;#5 &nbsp;je_arena_mapbits_allocated_get&nbsp;(pageind=0,&nbsp;chunk=0x7fffdc000000)&nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/include/jemalloc/internal/arena.h:766&lt;br&gt;#6 &nbsp;je_arena_salloc&nbsp;(ptr=ptr@entry=0x7fffdc000910,&nbsp;demote=demote@entry=false)&nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/include/jemalloc/internal/arena.h:1217&lt;br&gt;#7 &nbsp;0x00000000004238fb&nbsp;in&nbsp;je_isalloc&nbsp;(demote=false,&nbsp;ptr=0x7fffdc000910)&nbsp;at&nbsp;include/jemalloc/internal/jemalloc_internal.h:880&lt;br&gt;#8 &nbsp;ifree&nbsp;(tcache=0x7ffff704c000,&nbsp;ptr=0x7fffdc000910,&nbsp;tsd=0x7ffff51ff650)&nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/src/jemalloc.c:1740&lt;br&gt;#9 &nbsp;je_free&nbsp;(ptr=0x7fffdc000910)&nbsp;at&nbsp;/home/edsiper/coding/monkey/deps/jemalloc/src/jemalloc.c:1839&lt;br&gt;#10&nbsp;0x0000000000419537&nbsp;in&nbsp;mk_mem_free&nbsp;(ptr=0x7fffdc000910)&nbsp;at&nbsp;/home/edsiper/coding/monkey/mk_core/include/mk_core/mk_memory.h:96&lt;br&gt;#11&nbsp;0x000000000041991c&nbsp;in&nbsp;mk_iov_free_marked&nbsp;(mk_io=0x7ffff447f000)&nbsp;at&nbsp;/home/edsiper/coding/monkey/mk_core/mk_iov.c:143&lt;br&gt;#12&nbsp;0x00000000004198c7&nbsp;in&nbsp;mk_iov_free&nbsp;(mk_io=0x7ffff447f000)&nbsp;at&nbsp;/home/edsiper/coding/monkey/mk_core/mk_iov.c:126&lt;br&gt;#13&nbsp;0x00007ffff6dfcc1a&nbsp;in&nbsp;fcgi_exit&nbsp;(handler=0x7ffff446a1c0)&nbsp;at&nbsp;/home/edsiper/coding/monkey/plugins/fastcgi/fcgi_handler.c:405&lt;br&gt;#14&nbsp;0x00007ffff6dfd09b&nbsp;in&nbsp;cb_fastcgi_on_read&nbsp;(data=0x7ffff446a1c0)&nbsp;at&nbsp;/home/edsiper/coding/monkey/plugins/fastcgi/fcgi_handler.c:521&lt;br&gt;#15&nbsp;0x0000000000412598&nbsp;in&nbsp;mk_server_worker_loop&nbsp;()&nbsp;at&nbsp;/home/edsiper/coding/monkey/mk_server/mk_server.c:455&lt;br&gt;#16&nbsp;0x000000000040aa6b&nbsp;in&nbsp;mk_sched_launch_worker_loop&nbsp;(thread_conf=0x7ffff701c538)&nbsp;at&nbsp;/home/edsiper/coding/monkey/mk_server/mk_scheduler.c:394&lt;br&gt;#17&nbsp;0x00007ffff7bc26aa&nbsp;in&nbsp;start_thread&nbsp;(arg=0x7ffff51ff700)&nbsp;at&nbsp;pthread_create.c:333&lt;br&gt;#18&nbsp;0x00007ffff76f3eed&nbsp;in&nbsp;clone&nbsp;()&nbsp;at&nbsp;../sysdeps/unix/sysv/linux/x86_64/clone.S:109&lt;br&gt;---&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Eduardo&nbsp;Silva&lt;br&gt;&lt;a&nbsp;href=&quot;http://edsiper.linuxchile.cl&quot;&nbsp;target=&quot;_blank&quot;&gt;http://edsiper.linuxchile.cl&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://monkey-project.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://monkey-project.com&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
