<tt>
&lt;div&nbsp;style=&quot;line-height:1.7;color:#000000;font-size:14px;font-family:Arial&quot;&gt;&lt;div&gt;Hi,&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;been&nbsp;reading&nbsp;the&nbsp;Je&nbsp;source&nbsp;code,&nbsp;and&nbsp;I&nbsp;have&nbsp;some&nbsp;question&nbsp;about&nbsp;the&nbsp;purging&nbsp;order.&lt;br&gt;The&nbsp;fisrt&nbsp;one&nbsp;is&nbsp;,&nbsp;according&nbsp;to&nbsp;the&nbsp;code&nbsp;comments,&nbsp;the&nbsp;clean-dirty&nbsp;fragmentation&nbsp;is&nbsp;measured&nbsp;as,&lt;br&gt;&lt;br&gt;*&nbsp;Order&nbsp;such&nbsp;that&nbsp;chunks&nbsp;with&nbsp;higher&nbsp;fragmentation&nbsp;are&nbsp;&quot;less&nbsp;than&quot;&lt;br&gt;*&nbsp;those&nbsp;with&nbsp;lower&nbsp;fragmentation&nbsp;--&nbsp;purging&nbsp;order&nbsp;is&nbsp;from&nbsp;&quot;least&quot;&nbsp;to&lt;br&gt;*&nbsp;&quot;greatest&quot;.&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;current&nbsp;avail&nbsp;run&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nruns_avail-nruns_adjac&lt;br&gt;--------------------------------------------&nbsp;&nbsp;=&nbsp;&nbsp;----------------------------------&lt;br&gt;mean&nbsp;defragmented&nbsp;avail&nbsp;run&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nruns_avail&lt;br&gt;&lt;br&gt;So&nbsp;if&nbsp;I&nbsp;have&nbsp;a&nbsp;chunkA&nbsp;with&nbsp;avail_runs&nbsp;=&nbsp;10,&nbsp;adjac&nbsp;=&nbsp;1,&nbsp;and&nbsp;another&nbsp;chunkB&nbsp;with&nbsp;avail_runs&nbsp;=&nbsp;20,&nbsp;adjac&nbsp;=&nbsp;5.&lt;br&gt;Obviously,&nbsp;the&nbsp;fragmentA(0.9)&nbsp;&gt;&nbsp;fragmentB(0.75),&nbsp;so&nbsp;the&nbsp;A&nbsp;will&nbsp;be&nbsp;prior&nbsp;to&nbsp;B&nbsp;in&nbsp;the&nbsp;dirty&nbsp;chunk&nbsp;tree,&nbsp;and&nbsp;&lt;br&gt;will&nbsp;be&nbsp;purged&nbsp;first.&nbsp;But&nbsp;the&nbsp;chunkB&nbsp;truely&nbsp;has&nbsp;more&nbsp;adjacs&nbsp;than&nbsp;the&nbsp;A,&nbsp;and&nbsp;the&nbsp;performace&nbsp;gain&nbsp;after&nbsp;purging&nbsp;&lt;br&gt;chunkA&nbsp;is&nbsp;also&nbsp;less&nbsp;than&nbsp;the&nbsp;other(0.1&nbsp;vs&nbsp;0.25).&nbsp;Why&nbsp;we&nbsp;prefer&nbsp;to&nbsp;purge&nbsp;the&nbsp;chunk&nbsp;with&nbsp;&quot;less&nbsp;adjacs&quot;?&nbsp;&lt;br&gt;Shouldn't&nbsp;we&nbsp;purge&nbsp;more&nbsp;adjacs&nbsp;or&nbsp;clean-dirty&nbsp;fragments&nbsp;to&nbsp;acquire&nbsp;more&nbsp;continuous&nbsp;unalloc&nbsp;pages?&lt;br&gt;&lt;br&gt;Another&nbsp;question&nbsp;is,&nbsp;I&nbsp;notice&nbsp;that&nbsp;before&nbsp;the&nbsp;git&nbsp;node&nbsp;e3d13060&nbsp;there&nbsp;are&nbsp;two&nbsp;avail-trees,&nbsp;one&nbsp;is&nbsp;for&nbsp;dirty,&nbsp;&lt;br&gt;and&nbsp;another&nbsp;for&nbsp;clean,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;arena_avail_tree_t&nbsp;&nbsp;&nbsp;&nbsp;runs_avail_clean;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;arena_avail_tree_t&nbsp;&nbsp;&nbsp;&nbsp;runs_avail_dirty;&lt;br&gt;After&nbsp;that,&nbsp;the&nbsp;two&nbsp;became&nbsp;one.&nbsp;So&nbsp;how&nbsp;to&nbsp;ensure&nbsp;the&nbsp;new&nbsp;runs&nbsp;allocaction&nbsp;to&nbsp;prefer&nbsp;to&nbsp;dirty&nbsp;pages?&nbsp;&lt;br&gt;Is&nbsp;the&nbsp;modification&nbsp;will&nbsp;cause&nbsp;more&nbsp;&lt;span&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;id=&quot;tran_0_4&quot;&gt;performance&nbsp;regression&nbsp;than&nbsp;before&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;br&gt;&lt;br&gt;That's&nbsp;all,&nbsp;thanks.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span&nbsp;title=&quot;neteasefooter&quot;&gt;&lt;p&gt;&nbsp;&lt;/p&gt;&lt;/span&gt;
</tt>
