<tt>
&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Hi&nbsp;Jason,&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Thx&nbsp;for&nbsp;taking&nbsp;the&nbsp;time&nbsp;to&nbsp;look&nbsp;into<br>
this&nbsp;!&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Below&nbsp;is&nbsp;the&nbsp;requested&nbsp;information.<br>
&nbsp;When&nbsp;I&nbsp;originally&nbsp;observed&nbsp;this&nbsp;behavior&nbsp;I&nbsp;was&nbsp;running&nbsp;with&nbsp;munmap<br>
disabled.&nbsp;&nbsp;We&nbsp;are&nbsp;currently&nbsp;running&nbsp;with&nbsp;it&nbsp;enabled,&nbsp;to&nbsp;see&nbsp;how&nbsp;much<br>
it&nbsp;helps&nbsp;or&nbsp;hurts&nbsp;us.&nbsp;&nbsp;Private_Clean&nbsp;is&nbsp;still&nbsp;high&nbsp;with&nbsp;munmap&nbsp;enabled,<br>
however&nbsp;our&nbsp;processes&nbsp;RSS&nbsp;seems&nbsp;to&nbsp;be&nbsp;growing&nbsp;slower.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Also,&nbsp;we&nbsp;have&nbsp;swapping&nbsp;disabled.&nbsp;&nbsp;Mainly<br>
because&nbsp;we&nbsp;are&nbsp;running&nbsp;a&nbsp;bunch&nbsp;of&nbsp;java&nbsp;processes&nbsp;for&nbsp;which&nbsp;we&nbsp;don't&nbsp;want<br>
any&nbsp;of&nbsp;the&nbsp;JVM&nbsp;to&nbsp;ever&nbsp;be&nbsp;swapped.&nbsp;&nbsp;It's&nbsp;unclear&nbsp;if&nbsp;enabling&nbsp;swap<br>
will&nbsp;help&nbsp;us&nbsp;avoid&nbsp;the&nbsp;OS&nbsp;OOM&nbsp;killer,&nbsp;however&nbsp;we&nbsp;will&nbsp;soon&nbsp;be&nbsp;running&nbsp;some<br>
experiments&nbsp;with&nbsp;swap&nbsp;enabled.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;I've&nbsp;been&nbsp;try&nbsp;to&nbsp;catch&nbsp;strace&nbsp;when&nbsp;the<br>
Private_Clean&nbsp;is&nbsp;growing.&nbsp;&nbsp;Not&nbsp;sure&nbsp;if&nbsp;you&nbsp;are&nbsp;asking&nbsp;for&nbsp;a&nbsp;full&nbsp;strace<br>
or&nbsp;whether&nbsp;the&nbsp;summary&nbsp;is&nbsp;good&nbsp;enough.&nbsp;&nbsp;A&nbsp;full&nbsp;strace&nbsp;would&nbsp;be&nbsp;way<br>
too&nbsp;large&nbsp;as&nbsp;our&nbsp;server&nbsp;is&nbsp;under&nbsp;full&nbsp;load&nbsp;with&nbsp;tens&nbsp;of&nbsp;thousands&nbsp;of&nbsp;allocations<br>
every&nbsp;second.&nbsp;&nbsp;The&nbsp;summary&nbsp;is&nbsp;attached&nbsp;below&nbsp;for&nbsp;a&nbsp;30&nbsp;minute&nbsp;duration,<br>
during&nbsp;which&nbsp;time&nbsp;I&nbsp;observed&nbsp;a&nbsp;single&nbsp;smap&nbsp;grow&nbsp;by&nbsp;100MB&nbsp;of&nbsp;private&nbsp;clean<br>
pages.&nbsp;&nbsp;Over&nbsp;the&nbsp;next&nbsp;couple&nbsp;of&nbsp;hours&nbsp;it&nbsp;didn't&nbsp;grow&nbsp;at&nbsp;all,&nbsp;rather<br>
it&nbsp;shrunk&nbsp;by&nbsp;a&nbsp;couple&nbsp;of&nbsp;hundred&nbsp;MBs.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Please&nbsp;let&nbsp;me&nbsp;know&nbsp;if&nbsp;anything&nbsp;else<br>
is&nbsp;needed,&nbsp;or&nbsp;if&nbsp;you&nbsp;have&nbsp;any&nbsp;suggestions&nbsp;with&nbsp;other&nbsp;jemalloc&nbsp;config&nbsp;options<br>
or&nbsp;Linux&nbsp;tuning&nbsp;we&nbsp;maybe&nbsp;able&nbsp;to&nbsp;do&nbsp;to&nbsp;help.&nbsp;&nbsp;THX&nbsp;!&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;1)&nbsp;Linux&nbsp;version:&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Linux&nbsp;10.42.229.68&nbsp;2.6.32-131.21.1.89.br5_0.x86_64<br>
#1&nbsp;SMP&nbsp;Tue&nbsp;Mar&nbsp;19&nbsp;15:05:57&nbsp;CDT&nbsp;2013&nbsp;x86_64&nbsp;GNU/Linux&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;2)&nbsp;config&nbsp;options&nbsp;for&nbsp;jemalloc:&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;===============================================================================&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;jemalloc&nbsp;version&nbsp;&nbsp;&nbsp;:&nbsp;3.3.1-0-g9ef9d9e8c271cdf14f664b871a8f98c827714784&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;library&nbsp;revision&nbsp;&nbsp;&nbsp;:&nbsp;1&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;CC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;gcc&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;CPPFLAGS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;&nbsp;-D_GNU_SOURCE&nbsp;-D_REENTRANT&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;CFLAGS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;-std=gnu99&nbsp;-Wall&nbsp;-pipe&nbsp;-g3&nbsp;-fvisibility=hidden&nbsp;-O3&nbsp;-funroll-loops&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;LDFLAGS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;LIBS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;-lm&nbsp;-lpthread&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;RPATH_EXTRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;XSLTPROC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;/usr/bin/xsltproc&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;XSLROOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;/usr/share/sgml/docbook/xsl-stylesheets&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;PREFIX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;BINDIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/bin&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;INCLUDEDIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
:&nbsp;/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/include&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;LIBDIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/lib&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;DATADIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/share&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;MANDIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/share/man&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;srcroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;abs_srcroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/src/jemalloc-3.3.1/&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;objroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;abs_objroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
/root/kWebSphere/workspace/XS3/XS/ws/code/prereq.jemalloc/src/jemalloc-3.3.1/&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;JEMALLOC_PREFIX&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;je&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;JEMALLOC_PRIVATE_NAMESPACE&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;install_suffix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;autogen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;experimental&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;cc-silence&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;stats&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;prof&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;prof-libunwind&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;prof-libgcc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;prof-gcc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;tcache&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;fill&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;utrace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;valgrind&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;xmalloc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;mremap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;munmap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;:&nbsp;1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;dss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;lazy_lock&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;tls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;===============================================================================&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;3)&nbsp;jemalloc&nbsp;runtime:&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Version:&nbsp;3.3.1-0-g9ef9d9e8c271cdf14f664b871a8f98c827714784&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Assertions&nbsp;disabled&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Run-time&nbsp;option&nbsp;settings:&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.abort:&nbsp;false&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.lg_chunk:&nbsp;21&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.dss:&nbsp;&quot;secondary&quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.narenas:&nbsp;96&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.lg_dirty_mult:&nbsp;6&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.stats_print:&nbsp;false&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.junk:&nbsp;false&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.quarantine:&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.redzone:&nbsp;false&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;opt.zero:&nbsp;false&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;CPUs:&nbsp;24&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Arenas:&nbsp;96&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Pointer&nbsp;size:&nbsp;8&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Quantum&nbsp;size:&nbsp;16&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Page&nbsp;size:&nbsp;4096&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Min&nbsp;active:dirty&nbsp;page&nbsp;ratio&nbsp;per&nbsp;arena:<br>
64:1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Chunk&nbsp;size:&nbsp;2097152&nbsp;(2^21)&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;4)&nbsp;strace&nbsp;summary&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bye,&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kMartin&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;table&nbsp;width=100%&nbsp;style=&quot;border-collapse:collapse;&quot;&gt;<br>
&lt;tr&nbsp;valign=top&nbsp;height=8&gt;<br>
&lt;td&nbsp;width=96&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;From:&lt;/font&gt;<br>
&lt;td&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Jason<br>
Evans&nbsp;&lt;jasone@canonware.com&gt;&lt;/font&gt;<br>
&lt;tr&nbsp;valign=top&nbsp;height=8&gt;<br>
&lt;td&nbsp;width=96&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;To:&lt;/font&gt;<br>
&lt;td&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Kurtis<br>
Martin/Raleigh/IBM@IBMUS,&nbsp;&lt;/font&gt;<br>
&lt;tr&nbsp;height=8&gt;<br>
&lt;td&nbsp;width=96&nbsp;valign=top&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Cc:&lt;/font&gt;<br>
&lt;td&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;jemalloc-discuss@canonware.com&lt;/font&gt;<br>
&lt;tr&nbsp;valign=top&nbsp;height=8&gt;<br>
&lt;td&nbsp;width=96&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Date:&lt;/font&gt;<br>
&lt;td&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;06/03/2013<br>
07:23&nbsp;PM&lt;/font&gt;<br>
&lt;tr&nbsp;valign=top&nbsp;height=8&gt;<br>
&lt;td&nbsp;width=96&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Subject:&lt;/font&gt;<br>
&lt;td&nbsp;style=&quot;border-style:solid;border-color:#000000;border-width:0px&nbsp;0px&nbsp;0px&nbsp;0px;padding:0px&nbsp;0px;&quot;&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Re:<br>
High&nbsp;amount&nbsp;of&nbsp;private&nbsp;clean&nbsp;data&nbsp;in&nbsp;smaps&lt;/font&gt;&lt;/table&gt;<br>
&lt;br&gt;<br>
&lt;hr&nbsp;noshade&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=3&gt;On&nbsp;May&nbsp;30,&nbsp;2013,&nbsp;at&nbsp;4:06&nbsp;PM,&nbsp;Kurtis&nbsp;Martin&nbsp;wrote:&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;Segoe&nbsp;UI&quot;&gt;1)&nbsp;Why&nbsp;does&nbsp;jemalloc&nbsp;have&nbsp;smaps&nbsp;with&nbsp;such<br>
large&nbsp;Private_Clean&nbsp;size?&nbsp;&nbsp;I'm&nbsp;actually&nbsp;surprised&nbsp;jemalloc&nbsp;has&nbsp;such<br>
large&nbsp;smaps&nbsp;in&nbsp;general.&nbsp;&nbsp;I&nbsp;would&nbsp;expect&nbsp;a&nbsp;bunch&nbsp;of&nbsp;smaller&nbsp;smaps&nbsp;that<br>
match&nbsp;the&nbsp;configured&nbsp;chunk&nbsp;size.&lt;/font&gt;&lt;font&nbsp;size=3&gt;&nbsp;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=3&gt;I've&nbsp;been&nbsp;trying&nbsp;to&nbsp;figure&nbsp;this&nbsp;out&nbsp;for&nbsp;quite&nbsp;a&nbsp;while<br>
now,&nbsp;and&nbsp;I&nbsp;have&nbsp;yet&nbsp;to&nbsp;come&nbsp;up&nbsp;a&nbsp;way&nbsp;to&nbsp;transition&nbsp;pages&nbsp;that&nbsp;were&nbsp;mapped<br>
as&nbsp;MAP_PRIVATE|MAP_ANON&nbsp;to&nbsp;the&nbsp;Private_Clean&nbsp;state.&nbsp;&nbsp;My&nbsp;experiments<br>
included&nbsp;fork(2)&nbsp;abuse,&nbsp;mmap'ed&nbsp;files,&nbsp;shared&nbsp;anonymous&nbsp;memory,&nbsp;etc.,&nbsp;and<br>
I'm&nbsp;currently&nbsp;out&nbsp;of&nbsp;ideas.&nbsp;&nbsp;If&nbsp;you're&nbsp;able&nbsp;to&nbsp;observe&nbsp;a&nbsp;process&nbsp;as<br>
its&nbsp;Private_Clean&nbsp;page&nbsp;count&nbsp;is&nbsp;increasing,&nbsp;can&nbsp;you&nbsp;capture&nbsp;an&nbsp;strace&nbsp;log<br>
to&nbsp;see&nbsp;what&nbsp;system&nbsp;calls&nbsp;are&nbsp;occurring?&nbsp;&nbsp;Also,&nbsp;can&nbsp;you&nbsp;tell&nbsp;me&nbsp;the<br>
Linux&nbsp;kernel&nbsp;version&nbsp;you're&nbsp;using,&nbsp;jemalloc&nbsp;configuration&nbsp;(e.g.&nbsp;whether<br>
munmap&nbsp;is&nbsp;disabled),&nbsp;and&nbsp;jemalloc&nbsp;run-time&nbsp;options&nbsp;specified?&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=3&gt;Regarding&nbsp;large&nbsp;smaps,&nbsp;all&nbsp;the&nbsp;Unix&nbsp;operating&nbsp;systems<br>
I've&nbsp;dealt&nbsp;with&nbsp;coalesce&nbsp;mappings&nbsp;that&nbsp;have&nbsp;identical&nbsp;attributes.&nbsp;&nbsp;If<br>
jemalloc&nbsp;maps&nbsp;two&nbsp;chunks&nbsp;that&nbsp;happen&nbsp;to&nbsp;be&nbsp;adjacent&nbsp;to&nbsp;each&nbsp;other,&nbsp;the<br>
kernel&nbsp;tracks&nbsp;them&nbsp;as&nbsp;a&nbsp;single&nbsp;mapping.&nbsp;&nbsp;jemalloc&nbsp;goes&nbsp;to&nbsp;some&nbsp;effort<br>
to&nbsp;make&nbsp;coalescing&nbsp;possible,&nbsp;because&nbsp;Linux&nbsp;unfortunately&nbsp;does&nbsp;linear&nbsp;map<br>
scans&nbsp;that&nbsp;severely&nbsp;degrade&nbsp;performance&nbsp;if&nbsp;the&nbsp;number&nbsp;of&nbsp;map&nbsp;entries&nbsp;isn't<br>
kept&nbsp;low.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=3&gt;Thanks,&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=3&gt;Jason&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;
</tt>
