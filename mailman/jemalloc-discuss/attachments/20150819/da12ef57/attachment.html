<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;#000000&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;id=&quot;zwchr&quot;&nbsp;data-marker=&quot;__DIVIDER__&quot;&gt;-----&nbsp;On&nbsp;Aug&nbsp;19,&nbsp;2015,&nbsp;at&nbsp;8:44&nbsp;PM,&nbsp;Jason&nbsp;Evans&nbsp;&lt;jasone@canonware.com&gt;&nbsp;wrote:&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;blockquote&nbsp;style=&quot;border-left:&nbsp;2px&nbsp;solid&nbsp;#1010FF;&nbsp;margin-left:&nbsp;5px;&nbsp;padding-left:&nbsp;5px;&nbsp;color:&nbsp;#000;&nbsp;font-weight:&nbsp;normal;&nbsp;font-style:&nbsp;normal;&nbsp;text-decoration:&nbsp;none;&nbsp;font-family:&nbsp;Helvetica,Arial,sans-serif;&nbsp;font-size:&nbsp;12pt;&quot;&nbsp;data-mce-style=&quot;border-left:&nbsp;2px&nbsp;solid&nbsp;#1010FF;&nbsp;margin-left:&nbsp;5px;&nbsp;padding-left:&nbsp;5px;&nbsp;color:&nbsp;#000;&nbsp;font-weight:&nbsp;normal;&nbsp;font-style:&nbsp;normal;&nbsp;text-decoration:&nbsp;none;&nbsp;font-family:&nbsp;Helvetica,Arial,sans-serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;On&nbsp;Aug&nbsp;19,&nbsp;2015,&nbsp;at&nbsp;3:02&nbsp;AM,&nbsp;Ingvar&nbsp;Hagelund&nbsp;&lt;ingvar@redpill-linpro.com&gt;&nbsp;wrote:&lt;br&gt;&gt;&nbsp;I've&nbsp;started&nbsp;wrapping&nbsp;jemalloc-4.0.0&nbsp;for&nbsp;fedora.&nbsp;aarch64&nbsp;is&nbsp;now&nbsp;a&nbsp;target&lt;br&gt;&gt;&nbsp;arch&nbsp;for&nbsp;fedora.&nbsp;When&nbsp;sent&nbsp;to&nbsp;the&nbsp;arm&nbsp;builders,&nbsp;the&nbsp;unit/bitmap&nbsp;test&lt;br&gt;&gt;&nbsp;segfaults.&nbsp;Full&nbsp;log&nbsp;here:&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;http://arm.koji.fedoraproject.org//work/tasks/6832/3126832/build.log&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Also&nbsp;note&nbsp;the&nbsp;vast&nbsp;amounts&nbsp;of&nbsp;&quot;warning:&nbsp;left&nbsp;shift&nbsp;count&nbsp;is&nbsp;negative&quot;.&lt;br&gt;&lt;br&gt;This&nbsp;happens&nbsp;with&nbsp;page&nbsp;sizes&nbsp;larger&nbsp;than&nbsp;8&nbsp;KiB.&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;That's&nbsp;the&nbsp;case&nbsp;here,&nbsp;yes.&nbsp;Fedora&nbsp;22&nbsp;on&nbsp;aarch64.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;$&nbsp;uname&nbsp;-a&lt;br&gt;Linux&nbsp;arm64&nbsp;4.0.4-301.fc22.aarch64&nbsp;#1&nbsp;SMP&nbsp;Thu&nbsp;May&nbsp;21&nbsp;15:21:42&nbsp;UTC&nbsp;2015&nbsp;aarch64&nbsp;aarch64&nbsp;aarch64&nbsp;GNU/Linux&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;$&nbsp;getconf&nbsp;PAGESIZE&lt;br&gt;65536&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;border-left:&nbsp;2px&nbsp;solid&nbsp;#1010FF;&nbsp;margin-left:&nbsp;5px;&nbsp;padding-left:&nbsp;5px;&nbsp;color:&nbsp;#000;&nbsp;font-weight:&nbsp;normal;&nbsp;font-style:&nbsp;normal;&nbsp;text-decoration:&nbsp;none;&nbsp;font-family:&nbsp;Helvetica,Arial,sans-serif;&nbsp;font-size:&nbsp;12pt;&quot;&nbsp;data-mce-style=&quot;border-left:&nbsp;2px&nbsp;solid&nbsp;#1010FF;&nbsp;margin-left:&nbsp;5px;&nbsp;padding-left:&nbsp;5px;&nbsp;color:&nbsp;#000;&nbsp;font-weight:&nbsp;normal;&nbsp;font-style:&nbsp;normal;&nbsp;text-decoration:&nbsp;none;&nbsp;font-family:&nbsp;Helvetica,Arial,sans-serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&nbsp;I&nbsp;can&nbsp;test&nbsp;a&nbsp;patch&nbsp;locally&nbsp;by&nbsp;specifying&nbsp;--with-lg-page=16&nbsp;during&nbsp;configuration.&nbsp;&nbsp;The&nbsp;segfault&nbsp;is&nbsp;hopefully&nbsp;a&nbsp;side&nbsp;effect&nbsp;of&nbsp;the&nbsp;bit&nbsp;shifting&nbsp;issue&nbsp;(I&nbsp;certainly&nbsp;get&nbsp;test&nbsp;crashes&nbsp;when&nbsp;specifying&nbsp;--with-lg-page=16).&lt;/blockquote&gt;&lt;div&gt;I&nbsp;have&nbsp;got&nbsp;a&nbsp;qemu&nbsp;aarch64&nbsp;instance&nbsp;running&nbsp;now,&nbsp;so&nbsp;I&nbsp;would&nbsp;happily&nbsp;test&nbsp;patches.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;throw&nbsp;in&nbsp;a&nbsp;gdb&nbsp;backtrace&nbsp;for&nbsp;good&nbsp;measure&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;[ingvar@arm64&nbsp;jemalloc-4.0.0]$&nbsp;gdb&nbsp;test/unit/bitmap&lt;br&gt;GNU&nbsp;gdb&nbsp;(GDB)&nbsp;Fedora&nbsp;7.9-11.fc22&lt;br&gt;&lt;/div&gt;&lt;div&gt;(...snip...)&lt;/div&gt;&lt;div&gt;This&nbsp;GDB&nbsp;was&nbsp;configured&nbsp;as&nbsp;&quot;aarch64-redhat-linux-gnu&quot;.&lt;br&gt;(...snip....)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;Reading&nbsp;symbols&nbsp;from&nbsp;test/unit/bitmap...done.&lt;br&gt;(gdb)&nbsp;run&lt;br&gt;Starting&nbsp;program:&nbsp;/home/ingvar/rpmbuild/BUILD/jemalloc-4.0.0/test/unit/bitmap&nbsp;&lt;br&gt;[Thread&nbsp;debugging&nbsp;using&nbsp;libthread_db&nbsp;enabled]&lt;br&gt;Using&nbsp;host&nbsp;libthread_db&nbsp;library&nbsp;&quot;/lib64/libthread_db.so.1&quot;.&lt;br&gt;test_bitmap_size:&nbsp;pass&lt;br&gt;&lt;br&gt;Program&nbsp;received&nbsp;signal&nbsp;SIGSEGV,&nbsp;Segmentation&nbsp;fault.&lt;br&gt;__GI___pthread_mutex_lock&nbsp;(mutex=mutex@entry=0x840)&nbsp;at&nbsp;pthread_mutex_lock.c:67&lt;br&gt;67&nbsp;unsigned&nbsp;int&nbsp;type&nbsp;=&nbsp;PTHREAD_MUTEX_TYPE_ELISION&nbsp;(mutex);&lt;br&gt;(gdb)&nbsp;bt&lt;br&gt;#0&nbsp;__GI___pthread_mutex_lock&nbsp;(mutex=mutex@entry=0x840)&nbsp;at&nbsp;pthread_mutex_lock.c:67&lt;br&gt;#1&nbsp;0x000000000042f704&nbsp;in&nbsp;jet_malloc_mutex_lock&nbsp;(mutex=0x14ae70840)&nbsp;at&nbsp;include/jemalloc/internal/mutex.h:85&lt;br&gt;#2&nbsp;jet_tcache_bin_flush_small&nbsp;(tsd=tsd@entry=0x3ffb7810008,&nbsp;tcache=tcache@entry=0x3ffb7820000,&nbsp;tbin=tbin@entry=0x3ffb7820020,&nbsp;binind=binind@entry=0,&nbsp;rem=1768846639)&nbsp;at&nbsp;src/tcache.c:115&lt;br&gt;#3&nbsp;0x0000000000408574&nbsp;in&nbsp;jet_tcache_dalloc_small&nbsp;(binind=0,&nbsp;ptr=0x3ffb7a78f00,&nbsp;tcache=0x3ffb7820000,&nbsp;tsd=0x3ffb7810008)&nbsp;at&nbsp;include/jemalloc/internal/tcache.h:376&lt;br&gt;#4&nbsp;jet_arena_dalloc&nbsp;(tcache=0x3ffb7820000,&nbsp;ptr=0x3ffb7a78f00,&nbsp;tsd=0x3ffb7810008)&nbsp;at&nbsp;include/jemalloc/internal/arena.h:1195&lt;br&gt;#5&nbsp;jet_idalloctm&nbsp;(is_metadata=false,&nbsp;tcache=0x3ffb7820000,&nbsp;ptr=0x3ffb7a78f00,&nbsp;tsd=0x3ffb7810008)&nbsp;at&nbsp;include/jemalloc/internal/jemalloc_internal.h:1005&lt;br&gt;#6&nbsp;jet_iqalloc&nbsp;(tcache=0x3ffb7820000,&nbsp;ptr=0x3ffb7a78f00,&nbsp;tsd=0x3ffb7810008)&nbsp;at&nbsp;include/jemalloc/internal/jemalloc_internal.h:1029&lt;br&gt;#7&nbsp;ifree&nbsp;(tcache=0x3ffb7820000,&nbsp;ptr=0x3ffb7a78f00,&nbsp;tsd=0x3ffb7810008)&nbsp;at&nbsp;src/jemalloc.c:1723&lt;br&gt;#8&nbsp;jet_free&nbsp;(ptr=ptr@entry=0x3ffb7a78f00)&nbsp;at&nbsp;src/jemalloc.c:1817&lt;br&gt;#9&nbsp;0x0000000000401a84&nbsp;in&nbsp;test_bitmap_init&nbsp;()&nbsp;at&nbsp;test/unit/bitmap.c:34&lt;br&gt;#10&nbsp;0x0000000000434a20&nbsp;in&nbsp;p_test&nbsp;(t=0x401970&nbsp;&lt;test_bitmap_init&gt;)&nbsp;at&nbsp;test/src/test.c:84&lt;br&gt;#11&nbsp;0x000003ffb7d1f964&nbsp;in&nbsp;__libc_start_main&nbsp;(main=0x0,&nbsp;argc=0,&nbsp;argv=0x0,&nbsp;init=&lt;optimized&nbsp;out&gt;,&nbsp;fini=&lt;optimized&nbsp;out&gt;,&nbsp;rtld_fini=&lt;optimized&nbsp;out&gt;,&nbsp;stack_end=&lt;optimized&nbsp;out&gt;)&nbsp;at&nbsp;libc-start.c:289&lt;br&gt;#12&nbsp;0x00000000004016f0&nbsp;in&nbsp;_start&nbsp;()&lt;br&gt;Backtrace&nbsp;stopped:&nbsp;previous&nbsp;frame&nbsp;identical&nbsp;to&nbsp;this&nbsp;frame&nbsp;(corrupt&nbsp;stack?)&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
