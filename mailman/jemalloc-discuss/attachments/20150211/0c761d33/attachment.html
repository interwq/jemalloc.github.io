<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;So&nbsp;I&nbsp;think&nbsp;we&#39;re&nbsp;closing&nbsp;in&nbsp;on&nbsp;the&nbsp;finish&nbsp;line.&nbsp;I&#39;ve&nbsp;successfully&nbsp;generated&nbsp;profiles&nbsp;from&nbsp;ardb&nbsp;using&nbsp;the&nbsp;gate&nbsp;tip&nbsp;malloc.&nbsp;The&nbsp;problem&nbsp;I&#39;m&nbsp;having&nbsp;is&nbsp;that&nbsp;pprof&nbsp;(the&nbsp;one&nbsp;distributed&nbsp;w/&nbsp;jemalloc)&nbsp;shows&nbsp;no&nbsp;allocation&nbsp;information.&nbsp;(I&nbsp;use&nbsp;the&nbsp;one&nbsp;distributed&nbsp;w/&nbsp;jemalloc&nbsp;b/c&nbsp;the&nbsp;one&nbsp;that&#39;s&nbsp;part&nbsp;of&nbsp;gperftools&nbsp;2.4&nbsp;doesn&#39;t&nbsp;know&nbsp;about&nbsp;heap_v2&nbsp;afaict.)&nbsp;To&nbsp;be&nbsp;clear,&nbsp;pprof&nbsp;loads&nbsp;the&nbsp;file,&nbsp;then&nbsp;I&nbsp;do&nbsp;&quot;top&quot;&nbsp;and&nbsp;it&nbsp;says&nbsp;&#39;0&nbsp;B&#39;,&nbsp;as&nbsp;does&nbsp;&quot;top&nbsp;--cum&quot;.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;haven&#39;t&nbsp;found&nbsp;documentation&nbsp;about&nbsp;what&nbsp;the&nbsp;heap_v2&nbsp;file&nbsp;format&nbsp;is,&nbsp;so&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;where&nbsp;the&nbsp;problem&nbsp;is.&nbsp;I&#39;ve&nbsp;included&nbsp;what&nbsp;one&nbsp;of&nbsp;the&nbsp;profile&nbsp;files&nbsp;looks&nbsp;like.&nbsp;If&nbsp;you&nbsp;can&nbsp;point&nbsp;me&nbsp;to&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;heap_v2&nbsp;file&nbsp;format&nbsp;that&nbsp;would&nbsp;be&nbsp;great,&nbsp;then&nbsp;I&nbsp;could&nbsp;possibly&nbsp;interpret&nbsp;what&#39;s&nbsp;below.&nbsp;If&nbsp;you&nbsp;know&nbsp;what&#39;s&nbsp;going&nbsp;on&nbsp;when&nbsp;you&nbsp;look&nbsp;@&nbsp;the&nbsp;file&nbsp;below,&nbsp;that&nbsp;would&nbsp;be&nbsp;great&nbsp;as&nbsp;well.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;heap_v2/524288&lt;br&gt; &nbsp;t*:&nbsp;217:&nbsp;3029560&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t0:&nbsp;6:&nbsp;1015808&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t1:&nbsp;0:&nbsp;0&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t2:&nbsp;207:&nbsp;1440312&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t3:&nbsp;0:&nbsp;0&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t4:&nbsp;0:&nbsp;0&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t5:&nbsp;0:&nbsp;0&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t6:&nbsp;0:&nbsp;0&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t7:&nbsp;4:&nbsp;573440&nbsp;[0:&nbsp;0]&lt;br&gt;@&lt;br&gt; &nbsp;t*:&nbsp;217:&nbsp;3029560&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t0:&nbsp;6:&nbsp;1015808&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t2:&nbsp;207:&nbsp;1440312&nbsp;[0:&nbsp;0]&lt;br&gt; &nbsp;t7:&nbsp;4:&nbsp;573440&nbsp;[0:&nbsp;0]&lt;br&gt;MAPPED_LIBRARIES:&lt;br&gt;00008000-001f5000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;1318210 &nbsp; &nbsp;/usr/bin/ardb-server.prof&lt;br&gt;001fc000-00202000&nbsp;rw-p&nbsp;001ec000&nbsp;08:05&nbsp;1318210 &nbsp; &nbsp;/usr/bin/ardb-server.prof&lt;br&gt;00202000-00214000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[heap]&lt;br&gt;a6000000-adc00000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;adc00000-adc01000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;adc01000-af400000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:5192]&lt;br&gt;af400000-af401000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;af401000-b0400000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:4628]&lt;br&gt;b0400000-b0401000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b0401000-b1000000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:4627]&lt;br&gt;b11ff000-b1200000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b1200000-b19ff000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:4626]&lt;br&gt;b19ff000-b1a00000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b1a00000-b21ff000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:4625]&lt;br&gt;b21ff000-b2200000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b2200000-b29ff000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:4624]&lt;br&gt;b29ff000-b2a00000&nbsp;---p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b2a00000-b31ff000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack:4623]&lt;br&gt;b31ff000-b6400000&nbsp;rw-s&nbsp;00000000&nbsp;08:06&nbsp;2883593 &nbsp; &nbsp;&lt;&gt;/repl/repl.log&lt;br&gt;b6400000-b6c00000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6d25000-b6d26000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6d27000-b6e42000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;130837&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libc-2.13.so&quot;&gt;libc-2.13.so&lt;/a&gt;&lt;br&gt;b6e42000-b6e49000&nbsp;---p&nbsp;0011b000&nbsp;08:05&nbsp;130837&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libc-2.13.so&quot;&gt;libc-2.13.so&lt;/a&gt;&lt;br&gt;b6e49000-b6e4b000&nbsp;r--p&nbsp;0011a000&nbsp;08:05&nbsp;130837&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libc-2.13.so&quot;&gt;libc-2.13.so&lt;/a&gt;&lt;br&gt;b6e4b000-b6e4c000&nbsp;rw-p&nbsp;0011c000&nbsp;08:05&nbsp;130837&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libc-2.13.so&quot;&gt;libc-2.13.so&lt;/a&gt;&lt;br&gt;b6e4c000-b6e4f000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6e4f000-b6e6e000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;130944&nbsp; &nbsp; &nbsp;/lib/libgcc_s.so.1&lt;br&gt;b6e6e000-b6e75000&nbsp;---p&nbsp;0001f000&nbsp;08:05&nbsp;130944&nbsp; &nbsp; &nbsp;/lib/libgcc_s.so.1&lt;br&gt;b6e75000-b6e76000&nbsp;rw-p&nbsp;0001e000&nbsp;08:05&nbsp;130944&nbsp; &nbsp; &nbsp;/lib/libgcc_s.so.1&lt;br&gt;b6e76000-b6edf000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;130976&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libm-2.13.so&quot;&gt;libm-2.13.so&lt;/a&gt;&lt;br&gt;b6edf000-b6ee6000&nbsp;---p&nbsp;00069000&nbsp;08:05&nbsp;130976&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libm-2.13.so&quot;&gt;libm-2.13.so&lt;/a&gt;&lt;br&gt;b6ee6000-b6ee7000&nbsp;r--p&nbsp;00068000&nbsp;08:05&nbsp;130976&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libm-2.13.so&quot;&gt;libm-2.13.so&lt;/a&gt;&lt;br&gt;b6ee7000-b6ee8000&nbsp;rw-p&nbsp;00069000&nbsp;08:05&nbsp;130976&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libm-2.13.so&quot;&gt;libm-2.13.so&lt;/a&gt;&lt;br&gt;b6ee8000-b6f84000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;1316222 &nbsp; &nbsp;/usr/lib/libstdc++.so.6.0.17&lt;br&gt;b6f84000-b6f8b000&nbsp;---p&nbsp;0009c000&nbsp;08:05&nbsp;1316222 &nbsp; &nbsp;/usr/lib/libstdc++.so.6.0.17&lt;br&gt;b6f8b000-b6f8f000&nbsp;r--p&nbsp;0009b000&nbsp;08:05&nbsp;1316222 &nbsp; &nbsp;/usr/lib/libstdc++.so.6.0.17&lt;br&gt;b6f8f000-b6f91000&nbsp;rw-p&nbsp;0009f000&nbsp;08:05&nbsp;1316222 &nbsp; &nbsp;/usr/lib/libstdc++.so.6.0.17&lt;br&gt;b6f91000-b6f98000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6f98000-b6fac000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;130941&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libpthread-2.13.so&quot;&gt;libpthread-2.13.so&lt;/a&gt;&lt;br&gt;b6fac000-b6fb3000&nbsp;---p&nbsp;00014000&nbsp;08:05&nbsp;130941&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libpthread-2.13.so&quot;&gt;libpthread-2.13.so&lt;/a&gt;&lt;br&gt;b6fb3000-b6fb4000&nbsp;r--p&nbsp;00013000&nbsp;08:05&nbsp;130941&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libpthread-2.13.so&quot;&gt;libpthread-2.13.so&lt;/a&gt;&lt;br&gt;b6fb4000-b6fb5000&nbsp;rw-p&nbsp;00014000&nbsp;08:05&nbsp;130941&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://libpthread-2.13.so&quot;&gt;libpthread-2.13.so&lt;/a&gt;&lt;br&gt;b6fb5000-b6fb7000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6fb7000-b6fd4000&nbsp;r-xp&nbsp;00000000&nbsp;08:05&nbsp;130826&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://ld-2.13.so&quot;&gt;ld-2.13.so&lt;/a&gt;&lt;br&gt;b6fd4000-b6fd7000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6fd7000-b6fda000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &lt;br&gt;b6fda000-b6fdb000&nbsp;r-xp&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[sigpage]&lt;br&gt;b6fdb000-b6fdc000&nbsp;r--p&nbsp;0001c000&nbsp;08:05&nbsp;130826&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://ld-2.13.so&quot;&gt;ld-2.13.so&lt;/a&gt;&lt;br&gt;b6fdc000-b6fdd000&nbsp;rw-p&nbsp;0001d000&nbsp;08:05&nbsp;130826&nbsp; &nbsp; &nbsp;/lib/&lt;a&nbsp;href=&quot;http://ld-2.13.so&quot;&gt;ld-2.13.so&lt;/a&gt;&lt;br&gt;bef38000-bef59000&nbsp;rw-p&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[stack]&lt;br&gt;ffff0000-ffff1000&nbsp;r-xp&nbsp;00000000&nbsp;00:00&nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[vectors]&lt;/blockquote&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Brock&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Feb&nbsp;9,&nbsp;2015&nbsp;at&nbsp;3:23&nbsp;PM,&nbsp;Jason&nbsp;Evans&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jasone@canonware.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jasone@canonware.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;Feb&nbsp;9,&nbsp;2015,&nbsp;at&nbsp;3:11&nbsp;PM,&nbsp;Brock&nbsp;Pytlik&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:brock.pytlik@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;brock.pytlik@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/span&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Well,&nbsp;I&nbsp;thought&nbsp;it&nbsp;would&nbsp;handle&nbsp;what&nbsp;I&nbsp;needed,&nbsp;but&nbsp;I&nbsp;can&#39;t&nbsp;seem&nbsp;to&nbsp;get&nbsp;it&nbsp;to&nbsp;produce&nbsp;a&nbsp;dump.&nbsp;Here&#39;s&nbsp;what&nbsp;I&nbsp;did:&lt;div&gt;From&nbsp;my&nbsp;experiments&nbsp;on&nbsp;x86,&nbsp;it&nbsp;seems&nbsp;like&nbsp;prof:true&nbsp;needs&nbsp;to&nbsp;be&nbsp;part&nbsp;of&nbsp;MALLOC_CONF&nbsp;for&nbsp;lg_prof_interval&nbsp;to&nbsp;work&nbsp;at&nbsp;all.&nbsp;However,&nbsp;when&nbsp;I&nbsp;set&nbsp;prof:true&nbsp;on&nbsp;arm,&nbsp;ardb&nbsp;hangs&nbsp;in&nbsp;the&nbsp;atexit&nbsp;code.&nbsp;This&nbsp;happens&nbsp;even&nbsp;when&nbsp;I&nbsp;set&nbsp;prof_final&nbsp;to&nbsp;false.&nbsp;To&nbsp;be&nbsp;clear&nbsp;this&nbsp;command&nbsp;hangs&nbsp;(on&nbsp;arm):&lt;/div&gt;&lt;div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;MALLOC_CONF=prof:true,lg_prof_interval:2,prof_final:false&nbsp;ardb-server&nbsp;ardb.conf&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&gt;Oh,&nbsp;whoops,&nbsp;I&nbsp;forgot&nbsp;that&nbsp;in&nbsp;the&nbsp;dev&nbsp;branch&nbsp;I&nbsp;refactored&nbsp;the&nbsp;prof&nbsp;bootstrapping&nbsp;code&nbsp;to&nbsp;make&nbsp;the&nbsp;atexit()&nbsp;call&nbsp;conditional,&nbsp;but&nbsp;in&nbsp;3.6.0&nbsp;the&nbsp;call&nbsp;always&nbsp;happens&nbsp;if&nbsp;prof:true&nbsp;is&nbsp;set. &nbsp;I&nbsp;think&nbsp;you&nbsp;will&nbsp;have&nbsp;to&nbsp;hack&nbsp;jemalloc&nbsp;in&nbsp;order&nbsp;to&nbsp;work&nbsp;around&nbsp;this.&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;I&#39;m&nbsp;confused&nbsp;about&nbsp;a&nbsp;couple&nbsp;of&nbsp;things:&lt;/div&gt;&lt;div&gt;1)&nbsp;Why&nbsp;it&nbsp;works&nbsp;on&nbsp;x86&nbsp;and&nbsp;not&nbsp;arm&nbsp;(and&nbsp;whether&nbsp;that&nbsp;means&nbsp;the&nbsp;cross&nbsp;compiling&nbsp;build&nbsp;for&nbsp;arm&nbsp;has&nbsp;some&nbsp;issues).&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&gt;I&nbsp;haven&#39;t&nbsp;dug&nbsp;into&nbsp;this,&nbsp;but&nbsp;I&#39;m&nbsp;assuming&nbsp;that&nbsp;this&nbsp;is&nbsp;an&nbsp;arbitrary&nbsp;implementation&nbsp;difference&nbsp;in&nbsp;the&nbsp;libc&nbsp;being&nbsp;used&nbsp;on&nbsp;ARM,&nbsp;possibly&nbsp;motivated&nbsp;by&nbsp;the&nbsp;desire&nbsp;to&nbsp;reduce&nbsp;the&nbsp;data&nbsp;segment&nbsp;size&nbsp;and&nbsp;only&nbsp;pay&nbsp;for&nbsp;internal&nbsp;atexit()&nbsp;metadata&nbsp;overhead&nbsp;if&nbsp;the&nbsp;functionality&nbsp;is&nbsp;actually&nbsp;used. &nbsp;I&#39;m&nbsp;not&nbsp;very&nbsp;familiar&nbsp;with&nbsp;ARM-specific&nbsp;development,&nbsp;but&nbsp;I&nbsp;get&nbsp;the&nbsp;impression&nbsp;that&nbsp;there&nbsp;are&nbsp;multiple&nbsp;stripped&nbsp;down&nbsp;libc&nbsp;implementations&nbsp;in&nbsp;use.&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;If&nbsp;these&nbsp;are&nbsp;things&nbsp;that&nbsp;are&nbsp;fixed&nbsp;in&nbsp;the&nbsp;gate&nbsp;tip&nbsp;of&nbsp;jemalloc,&nbsp;I&#39;d&nbsp;also&nbsp;be&nbsp;happy&nbsp;to&nbsp;try&nbsp;changing&nbsp;ardb&nbsp;to&nbsp;use&nbsp;that&nbsp;(assuming&nbsp;it&#39;s&nbsp;largely&nbsp;a&nbsp;drop&nbsp;in&nbsp;replacement).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;suggestions&nbsp;on&nbsp;where&nbsp;I&nbsp;go&nbsp;next?&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Assuming&nbsp;that&nbsp;your&nbsp;current&nbsp;goal&nbsp;is&nbsp;simply&nbsp;to&nbsp;get&nbsp;heap&nbsp;profiles&nbsp;and&nbsp;diagnose&nbsp;a&nbsp;leak,&nbsp;I&#39;d&nbsp;recommend&nbsp;just&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;dev&nbsp;version&nbsp;of&nbsp;jemalloc. &nbsp;If&nbsp;that&nbsp;doesn&#39;t&nbsp;work&nbsp;for&nbsp;some&nbsp;reason,&nbsp;then&nbsp;disabling&nbsp;the&nbsp;atexit()&nbsp;call&nbsp;in&nbsp;jemalloc&#39;s&nbsp;src/prof.c&nbsp;and&nbsp;rebuilding&nbsp;will&nbsp;probably&nbsp;be&nbsp;enough&nbsp;to&nbsp;get&nbsp;you&nbsp;what&nbsp;you&nbsp;need.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Jason&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
