<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Hi,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;I&nbsp;am&nbsp;having&nbsp;problems&nbsp;with&nbsp;jemalloc&nbsp;3.4.1&nbsp;(currently&nbsp;we&nbsp;use&nbsp;2.2.2&nbsp;in&nbsp;production).&nbsp;I&nbsp;found&nbsp;that&nbsp;with&nbsp;jemalloc&nbsp;3.4.1&nbsp;function&nbsp;first&nbsp;argument&nbsp;will&nbsp;be&nbsp;changed&nbsp;if&nbsp;first&nbsp;argument&nbsp;is&nbsp;passed&nbsp;by&nbsp;XMM0&nbsp;register.&nbsp;Compiled&nbsp;with&nbsp;GCC&nbsp;4.8.1&nbsp;(tested&nbsp;also&nbsp;with&nbsp;4.8.2).&nbsp;No&nbsp;problems&nbsp;on&nbsp;Scientific&nbsp;Linux&nbsp;6&nbsp;(RHEL6-based),&nbsp;but&nbsp;it&nbsp;fails&nbsp;on&nbsp;Scientific&nbsp;Linux&nbsp;5&nbsp;(RHEL5-based).&nbsp;All&nbsp;of&nbsp;this&nbsp;is&nbsp;because&nbsp;_dl_lookup_symbol_x&nbsp;calls&nbsp;_realloc_&nbsp;in&nbsp;Scientific&nbsp;Linux&nbsp;5.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;This&nbsp;probably&nbsp;makes&nbsp;jemalloc&nbsp;3.4.1&nbsp;and&nbsp;the&nbsp;whole&nbsp;3.X.Y&nbsp;series&nbsp;not&nbsp;recommended&nbsp;for&nbsp;RHEL5&nbsp;and&nbsp;RHEL5-based&nbsp;distributions.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Original&nbsp;email&nbsp;below.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;My&nbsp;initial&nbsp;investigations&nbsp;were&nbsp;done&nbsp;on&nbsp;slc6_amd64_gcc481&nbsp;and&nbsp;the&nbsp;release&nbsp;is&nbsp;available&nbsp;for&nbsp;slc5_amd64_gcc481.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Most&nbsp;of&nbsp;the&nbsp;workflows&nbsp;will&nbsp;fail&nbsp;on&nbsp;this&nbsp;[slc5_amd64_gcc481]&nbsp;architecture,&nbsp;while&nbsp;on&nbsp;slc6_amd64_gcc481&nbsp;all&nbsp;workflows&nbsp;pass.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;If&nbsp;you&nbsp;are&nbsp;interested&nbsp;into&nbsp;the&nbsp;cause&nbsp;and&nbsp;calling&nbsp;conventions&nbsp;continue&nbsp;reading.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Most&nbsp;workflows&nbsp;fails&nbsp;with:&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;-----&nbsp;Begin&nbsp;Fatal&nbsp;Exception&nbsp;08-Nov-2013&nbsp;14:19:25&nbsp;CET-----------------------&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;An&nbsp;exception&nbsp;of&nbsp;category&nbsp;'InvalidIntervalError'&nbsp;occurred&nbsp;while&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;[0]&nbsp;Processing&nbsp;run:&nbsp;208307&nbsp;lumi:&nbsp;1&nbsp;event:&nbsp;643482&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;[1]&nbsp;Running&nbsp;path&nbsp;'reconstruction_step'&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;[2]&nbsp;Calling&nbsp;event&nbsp;method&nbsp;for&nbsp;module&nbsp;TrackIPProducer/'impactParameterTagInfos'&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Exception&nbsp;Message:&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Upper&nbsp;boundary&nbsp;below&nbsp;lower&nbsp;boundary&nbsp;in&nbsp;histogram&nbsp;integral.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;-----&nbsp;End&nbsp;Fatal&nbsp;Exception&nbsp;-------------------------------------------------&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Code&nbsp;triggering&nbsp;exception&nbsp;(CondFormats/PhysicsToolsObjects/interface/Histogram.icc):&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;244&nbsp;template&lt;typename&nbsp;Value_t,&nbsp;typename&nbsp;Axis_t&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;245&nbsp;Value_t&nbsp;Histogram&lt;Value_t,&nbsp;Axis_t&gt;::integral(Axis_t&nbsp;hBound,&nbsp;Axis_t&nbsp;lBound,&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;246&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;mode)&nbsp;const&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;247&nbsp;{&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;248&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(hBound&nbsp;&lt;&nbsp;lBound)&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;249&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;cms::Exception(&quot;InvalidIntervalError&quot;)&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;250&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;&quot;Upper&nbsp;boundary&nbsp;below&nbsp;lower&nbsp;boundary&nbsp;in&nbsp;&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;251&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;&quot;histogram&nbsp;integral.&quot;&nbsp;&lt;&lt;&nbsp;std::endl;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;The&nbsp;problem&nbsp;by&nbsp;example&nbsp;(description&nbsp;below):&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Dump&nbsp;of&nbsp;assembler&nbsp;code&nbsp;for&nbsp;function&nbsp;PhysicsTools::Calibration::Histogram&lt;float,&nbsp;float&gt;::normalizedIntegral(float,&nbsp;float,&nbsp;int)&nbsp;const:&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ceb0&nbsp;&lt;+0&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%rbx&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ceb1&nbsp;&lt;+1&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;%rdi,%rbx&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ceb4&nbsp;&lt;+4&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;&nbsp;&nbsp;&nbsp;$0x10,%rsp&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ceb8&nbsp;&lt;+8&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callq&nbsp;&nbsp;0x2aaabc6331e0&nbsp;&lt;_ZNK12PhysicsTools11Calibration9HistogramIffE8integralEffi@plt&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67cebd&nbsp;&lt;+13&gt;:&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;%rbx,%rdi&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67cec0&nbsp;&lt;+16&gt;:&nbsp;&nbsp;&nbsp;&nbsp;movss&nbsp;&nbsp;%xmm0,0xc(%rsp)&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67cec6&nbsp;&lt;+22&gt;:&nbsp;&nbsp;&nbsp;&nbsp;callq&nbsp;&nbsp;0x2aaabc632c80&nbsp;&lt;_ZNK12PhysicsTools11Calibration9HistogramIffE13normalizationEv@plt&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67cecb&nbsp;&lt;+27&gt;:&nbsp;&nbsp;&nbsp;&nbsp;movss&nbsp;&nbsp;0xc(%rsp),%xmm1&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ced1&nbsp;&lt;+33&gt;:&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;&nbsp;&nbsp;&nbsp;$0x10,%rsp&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ced5&nbsp;&lt;+37&gt;:&nbsp;&nbsp;&nbsp;&nbsp;divss&nbsp;&nbsp;%xmm0,%xmm1&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ced9&nbsp;&lt;+41&gt;:&nbsp;&nbsp;&nbsp;&nbsp;pop&nbsp;&nbsp;&nbsp;&nbsp;%rbx&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67ceda&nbsp;&lt;+42&gt;:&nbsp;&nbsp;&nbsp;&nbsp;movaps&nbsp;%xmm1,%xmm0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaabc67cedd&nbsp;&lt;+45&gt;:&nbsp;&nbsp;&nbsp;&nbsp;retq&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;End&nbsp;of&nbsp;assembler&nbsp;dump.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;this&nbsp;=&nbsp;0x2aab170a9ff0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;hBound&nbsp;=&nbsp;57.6329994&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;lBound&nbsp;=&nbsp;0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;mode&nbsp;=&nbsp;1&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Breakpoint&nbsp;1,&nbsp;PhysicsTools::Calibration::Histogram&lt;float,&nbsp;float&gt;::integral&nbsp;(this=0x2aab170a9ff0,&nbsp;hBound=-2.23135843e-10,&nbsp;lBound=0,&nbsp;mode=1)&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;&nbsp;at&nbsp;/build/davidlt/CMSSW_7_0_0_pre8_jemalloc341/src/CondFormats/PhysicsToolsObjects/interface/Histogram.icc:245&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;245&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value_t&nbsp;Histogram&lt;Value_t,&nbsp;Axis_t&gt;::integral(Axis_t&nbsp;hBound,&nbsp;Axis_t&nbsp;lBound,&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1:&nbsp;x/i&nbsp;$pc&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;=&gt;&nbsp;0x2aaabc67cbdc&nbsp;&lt;PhysicsTools::Calibration::Histogram&lt;float,&nbsp;float&gt;::integral(float,&nbsp;float,&nbsp;int)&nbsp;const&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%r14&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;this&nbsp;=&nbsp;0x2aab170a9ff0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;hBound&nbsp;=&nbsp;-2.23135843e-10&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;lBound&nbsp;=&nbsp;0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;mode&nbsp;=&nbsp;1&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;KA-BOOM!&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;_normalizedIntegral_&nbsp;calls&nbsp;_integral_&nbsp;with&nbsp;IDENTICAL&nbsp;arguments,&nbsp;yet&nbsp;once&nbsp;we&nbsp;reach&nbsp;_integral_&nbsp;body&nbsp;our&nbsp;_hBound_&nbsp;is&nbsp;changed&nbsp;to&nbsp;a&nbsp;different&nbsp;value.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;We&nbsp;call&nbsp;_integral_&nbsp;via&nbsp;PLT&nbsp;and&nbsp;we&nbsp;try&nbsp;to&nbsp;resolve&nbsp;the&nbsp;symbol&nbsp;(/lib64/ld-linux-x86-64.so.2).&nbsp;Between&nbsp;these&nbsp;two&nbsp;functions&nbsp;while&nbsp;we&nbsp;are&nbsp;resolving&nbsp;the&nbsp;symbol&nbsp;the&nbsp;value&nbsp;is&nbsp;modified.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;That&nbsp;happens&nbsp;in&nbsp;_dl_lookup_symbol_x&nbsp;(/lib64/ld-linux-x86-64.so.2)&nbsp;as&nbsp;on&nbsp;SLC5&nbsp;is&nbsp;calls&nbsp;_realloc_,&nbsp;and&nbsp;on&nbsp;SLC6&nbsp;library&nbsp;calls&nbsp;_malloc_.&nbsp;This&nbsp;is&nbsp;the&nbsp;reason&nbsp;why&nbsp;in&nbsp;works&nbsp;fine&nbsp;under&nbsp;SLC6,&nbsp;the&nbsp;change&nbsp;in&nbsp;dynamic&nbsp;linker/loader.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;_hBound_&nbsp;is&nbsp;stored&nbsp;in&nbsp;$xmm0.v4_float[0].&nbsp;It&nbsp;happens&nbsp;to&nbsp;be&nbsp;that&nbsp;in&nbsp;_realloc_&nbsp;(jemalloc)&nbsp;for&nbsp;this&nbsp;(src/jemalloc.c):&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1244&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ta-&gt;allocated&nbsp;+=&nbsp;usize;&lt;/span&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1244&nbsp;line&nbsp;compiler&nbsp;will&nbsp;generate&nbsp;SSE&nbsp;based&nbsp;code&nbsp;(using&nbsp;$xmm0).&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad381666&nbsp;&lt;+630&gt;:&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;%r12,0x28(%rsp)&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad38166b&nbsp;&lt;+635&gt;:&nbsp;&nbsp;&nbsp;movq&nbsp;&nbsp;&nbsp;0x28(%rsp),%xmm0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad381671&nbsp;&lt;+641&gt;:&nbsp;&nbsp;&nbsp;movhps&nbsp;0x20(%rsp),%xmm0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad381676&nbsp;&lt;+646&gt;:&nbsp;&nbsp;&nbsp;paddq&nbsp;&nbsp;(%rax),%xmm0&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad38167a&nbsp;&lt;+650&gt;:&nbsp;&nbsp;&nbsp;movdqa&nbsp;%xmm0,(%rax)&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad38167e&nbsp;&lt;+654&gt;:&nbsp;&nbsp;&nbsp;add&nbsp;&nbsp;&nbsp;&nbsp;$0x38,%rsp&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Just&nbsp;a&nbsp;few&nbsp;instructions&nbsp;which&nbsp;modify&nbsp;_hBound_&nbsp;value.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;Old&nbsp;value&nbsp;=&nbsp;57.6329994&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;New&nbsp;value&nbsp;=&nbsp;6.72623263e-44&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;0x00002aaaad381671&nbsp;in&nbsp;realloc&nbsp;(ptr=&lt;optimized&nbsp;out&gt;,&nbsp;size=&lt;optimized&nbsp;out&gt;)&nbsp;at&nbsp;src/jemalloc.c:1244&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;1244&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;src/jemalloc.c:&nbsp;No&nbsp;such&nbsp;file&nbsp;or&nbsp;directory.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;1:&nbsp;x/i&nbsp;$pc&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;=&gt;&nbsp;0x2aaaad381671&nbsp;&lt;realloc+641&gt;:&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;movhps&nbsp;0x20(%rsp),%xmm0&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;Continuing.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;Watchpoint&nbsp;7:&nbsp;$xmm0.v4_float[0]&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;Old&nbsp;value&nbsp;=&nbsp;6.72623263e-44&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;New&nbsp;value&nbsp;=&nbsp;-2.22548424e-10&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;0x00002aaaad38167a&nbsp;in&nbsp;realloc&nbsp;(ptr=&lt;optimized&nbsp;out&gt;,&nbsp;size=&lt;optimized&nbsp;out&gt;)&nbsp;at&nbsp;src/jemalloc.c:1244&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;1244&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;in&nbsp;src/jemalloc.c&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;1:&nbsp;x/i&nbsp;$pc&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;=&gt;&nbsp;0x2aaaad38167a&nbsp;&lt;realloc+650&gt;:&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;movdqa&nbsp;%xmm0,(%rax)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;Continuing.&lt;/font&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;If&nbsp;you&nbsp;look&nbsp;into&nbsp;&quot;Calling&nbsp;conventions&nbsp;for&nbsp;different&nbsp;C++&nbsp;compilers&nbsp;and&nbsp;operating&nbsp;systems&quot;.&nbsp;(I&nbsp;assume&nbsp;should&nbsp;be&nbsp;fine&nbsp;for&nbsp;C&nbsp;also,&nbsp;as&nbsp;they&nbsp;are&nbsp;compatible).&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;64-bit&nbsp;Linux.&nbsp;Callee-saved&nbsp;registers:&nbsp;RBX,&nbsp;RBP,&nbsp;R12-R15.&nbsp;All&nbsp;fine&nbsp;in&nbsp;jemallo&nbsp;_realloc_:&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Dump&nbsp;of&nbsp;assembler&nbsp;code&nbsp;for&nbsp;function&nbsp;realloc:&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803f0&nbsp;&lt;+0&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%r15&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803f2&nbsp;&lt;+2&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%r14&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803f4&nbsp;&lt;+4&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%r13&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803f6&nbsp;&lt;+6&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%r12&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803f8&nbsp;&lt;+8&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%rbp&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803f9&nbsp;&lt;+9&gt;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;%rsi,%rbp&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&nbsp;&nbsp;0x00002aaaad3803fc&nbsp;&lt;+12&gt;:&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;%rbx&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;But&nbsp;all&nbsp;other&nbsp;registers&nbsp;are&nbsp;scratch&nbsp;registers.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Also&nbsp;looking&nbsp;into&nbsp;&quot;System&nbsp;V&nbsp;Application&nbsp;Binary&nbsp;Interface&nbsp;AMD64&nbsp;Architecture&nbsp;Processor&nbsp;Supplement&quot;&nbsp;(October&nbsp;7,&nbsp;2013)&nbsp;[3.2.1&nbsp;section]&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Registers&nbsp;%rbp,&nbsp;%rbx&nbsp;and&nbsp;%r12&nbsp;through&nbsp;%r15&nbsp;&quot;belong&quot;&nbsp;to&nbsp;the&nbsp;calling&nbsp;function&nbsp;and&nbsp;the&nbsp;called&nbsp;function&nbsp;is&nbsp;required&nbsp;to&nbsp;preserve&nbsp;their&nbsp;values.&nbsp;In&nbsp;other&nbsp;words,&nbsp;a&nbsp;called&nbsp;function&nbsp;must&nbsp;preserve&nbsp;these&nbsp;registers'&nbsp;values&nbsp;for&nbsp;its&nbsp;caller.&nbsp;Remaining&nbsp;registers&nbsp;&quot;belong&quot;&nbsp;to&nbsp;the&nbsp;called&nbsp;function.&nbsp;If&nbsp;a&nbsp;calling&nbsp;function&nbsp;wants&nbsp;to&nbsp;preserve&nbsp;such&nbsp;a&nbsp;register&nbsp;value&nbsp;across&nbsp;a&nbsp;function&nbsp;call,&nbsp;it&nbsp;must&nbsp;save&nbsp;the&nbsp;value&nbsp;in&nbsp;its&nbsp;local&nbsp;stack&nbsp;frame.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;Simply&nbsp;put,&nbsp;according&nbsp;to&nbsp;this&nbsp;/lib64/ld-linux-x86-64.so.2&nbsp;dynamic&nbsp;linker/loader&nbsp;(_dl_lookup_symbol_x)&nbsp;before&nbsp;calling&nbsp;_realloc_&nbsp;had&nbsp;to&nbsp;take&nbsp;the&nbsp;action&nbsp;to&nbsp;protect&nbsp;xmm0&nbsp;register&nbsp;value.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;You&nbsp;cannot&nbsp;compile&nbsp;jemalloc&nbsp;without&nbsp;SSE:&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;include/jemalloc/internal/prof.h:349:40:&nbsp;error:&nbsp;SSE&nbsp;register&nbsp;return&nbsp;with&nbsp;SSE&nbsp;disabled&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;If&nbsp;we&nbsp;cannot&nbsp;jemalloc&nbsp;from&nbsp;using&nbsp;SSE&nbsp;registers,&nbsp;how&nbsp;can&nbsp;we&nbsp;go&nbsp;around&nbsp;the&nbsp;problem?&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1240&nbsp;&nbsp;&nbsp;if&nbsp;(config_stats&nbsp;&amp;&amp;&nbsp;ret&nbsp;!=&nbsp;NULL)&nbsp;{&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1241&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thread_allocated_t&nbsp;*ta;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1242&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(usize&nbsp;==&nbsp;isalloc(ret,&nbsp;config_prof));&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1243&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ta&nbsp;=&nbsp;thread_allocated_tsd_get();&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1244&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ta-&gt;allocated&nbsp;+=&nbsp;usize;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1245&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ta-&gt;deallocated&nbsp;+=&nbsp;old_size;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;1246&nbsp;&nbsp;&nbsp;}&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;In&nbsp;_realloc_&nbsp;1244&nbsp;line&nbsp;is&nbsp;wrapped&nbsp;around&nbsp;if&nbsp;with&nbsp;config_stats.&nbsp;Compiling&nbsp;jemalloc&nbsp;with&nbsp;--disable-stats&nbsp;options&nbsp;disables&nbsp;statistic&nbsp;collection,&nbsp;should&nbsp;also&nbsp;slightly&nbsp;increase&nbsp;performance.&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;It's&nbsp;a&nbsp;bit&nbsp;worrisome&nbsp;that&nbsp;arguments&nbsp;can&nbsp;change&nbsp;in&nbsp;between&nbsp;function&nbsp;calls.&lt;/span&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;monospace&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;david&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
