<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;great&nbsp;work&nbsp;on&nbsp;jemalloc&nbsp;first&nbsp;of&nbsp;all.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;In&nbsp;jemalloc&nbsp;3.0,&nbsp;this&nbsp;patch&nbsp;added&nbsp;the&nbsp;`--disable-munmap`&nbsp;option&nbsp;and&nbsp;disabled&nbsp;the&nbsp;use&nbsp;of&nbsp;`munmap`&nbsp;on&nbsp;Linux&nbsp;by&nbsp;default:&nbsp;&lt;a&nbsp;href=&quot;https://github.com/jemalloc/jemalloc/commit/59ae2766af88bad07ac721c4ee427b171e897bcb&quot;&gt;https://github.com/jemalloc/jemalloc/commit/59ae2766af88bad07ac721c4ee427b171e897bcb&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;It&nbsp;looks&nbsp;like&nbsp;jemalloc&nbsp;starting&nbsp;with&nbsp;version&nbsp;4.0&nbsp;makes&nbsp;use&nbsp;of&nbsp;`munmap`&nbsp;even&nbsp;when&nbsp;`--disable-munmap`&nbsp;is&nbsp;specified.&nbsp;From&nbsp;what&nbsp;I&nbsp;can&nbsp;tell,&nbsp;`chunk_map.c`&nbsp;honors&nbsp;the&nbsp;`config_munmap`&nbsp;flag,&nbsp;but&nbsp;the&nbsp;function&nbsp;`page_unmap`&nbsp;in&nbsp;`pages.c`&nbsp;ignores&nbsp;it&nbsp;(this&nbsp;code&nbsp;appears&nbsp;to&nbsp;be&nbsp;new&nbsp;in&nbsp;jemalloc&nbsp;4?).&lt;br&gt;&lt;br&gt;&lt;/div&gt;We&nbsp;are&nbsp;using&nbsp;jemalloc&nbsp;for&nbsp;RethinkDB&nbsp;and&nbsp;would&nbsp;like&nbsp;to&nbsp;upgrade&nbsp;to&nbsp;version&nbsp;4.1&nbsp;because&nbsp;we&nbsp;think&nbsp;that&nbsp;it&nbsp;fixes&nbsp;some&nbsp;bugs&nbsp;that&nbsp;our&nbsp;users&nbsp;have&nbsp;run&nbsp;into.&lt;br&gt;&lt;/div&gt;However&nbsp;it&nbsp;causes&nbsp;a&nbsp;regression&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;https://github.com/rethinkdb/rethinkdb/issues/3516&quot;&gt;https://github.com/rethinkdb/rethinkdb/issues/3516&lt;/a&gt;&nbsp;:&lt;br&gt;&quot;&lt;code&gt;&lt;jemalloc&gt;:&nbsp;Error&nbsp;in&nbsp;munmap():&nbsp;Cannot&nbsp;allocate&nbsp;memory&lt;/code&gt;&quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;-&nbsp;Daniel&lt;br&gt;&lt;/div&gt;<br>

</tt>
