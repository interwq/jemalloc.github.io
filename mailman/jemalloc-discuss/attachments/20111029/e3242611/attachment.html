<tt>
there&nbsp;is&nbsp;a&nbsp;bug&nbsp;in&nbsp;jemalloc-2.2.1&nbsp;on&nbsp;jemalloc.c&nbsp;line&nbsp;807&nbsp;in&nbsp;which&nbsp;key&nbsp;0&nbsp;is&nbsp;set&nbsp;before&nbsp;the&nbsp;key&nbsp;is&nbsp;created&nbsp;on&nbsp;line&nbsp;813.&nbsp; this&nbsp;may&nbsp;be&nbsp;the&nbsp;problem&nbsp;you&nbsp;are&nbsp;seeing.&nbsp; i&nbsp;moved&nbsp;the&nbsp;key&nbsp;create&nbsp;above&nbsp;the&nbsp;key&nbsp;use&nbsp;on&nbsp;my&nbsp;version&nbsp;of&nbsp;jemalloc.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;rich&nbsp;prohaska&lt;/div&gt;&lt;div&gt;tokutek&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sat,&nbsp;Oct&nbsp;29,&nbsp;2011&nbsp;at&nbsp;4:15&nbsp;PM,&nbsp;Kristen&nbsp;Eisenberg&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:kristen.eisenberg@yahoo.com&quot;&gt;kristen.eisenberg@yahoo.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;color:#000;background-color:#fff;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;<br>
&lt;div&gt;link&nbsp;with&nbsp;jemalloc.&nbsp;&nbsp;What&nbsp;happens&nbsp;is,&nbsp;after&nbsp;calling&nbsp;malloc(),&nbsp;the&lt;br&gt;value&nbsp;of&nbsp;one&nbsp;of&nbsp;my&nbsp;keys&nbsp;seems&nbsp;to&nbsp;change&nbsp;out&nbsp;from&nbsp;under&nbsp;me.&nbsp;&nbsp;Here&nbsp;is&nbsp;a&lt;br&gt;small&nbsp;example&nbsp;that&nbsp;demonstrates&nbsp;this:&lt;br&gt;&lt;a&nbsp;href=&quot;http://itsapad.appspot.com/fancy/6&quot;&nbsp;target=&quot;_blank&quot;&gt;http://itsapad.appspot.com/fancy/6&lt;/a&gt;.&nbsp;&nbsp;I&nbsp;am&nbsp;using&nbsp;jemalloc-2.2.1&nbsp;on&lt;br&gt;<br>
Linux.&nbsp;&nbsp;If&nbsp;I&nbsp;compile&nbsp;the&nbsp;example&nbsp;with&nbsp;gcc&nbsp;(ver&nbsp;4.4.3)&nbsp;using&nbsp;the&lt;br&gt;following&nbsp;command:&nbsp;&#39;gcc&nbsp;-lpthread&nbsp;main.c&#39;&nbsp;then&nbsp;both&nbsp;calls&nbsp;to&lt;br&gt;pthread_getspecific&nbsp;return&nbsp;a&nbsp;NULL&nbsp;pointer&nbsp;as&nbsp;expected.&nbsp;&nbsp;When&nbsp;I&nbsp;link&lt;br&gt;with&nbsp;jemalloc,&nbsp;however,&nbsp;(&#39;gcc&nbsp;-ljemalloc&nbsp;-lpthread&nbsp;main.c&#39;)&nbsp;then&nbsp;the&lt;br&gt;<br>
second&nbsp;call&nbsp;to&nbsp;pthread_getspecific&nbsp;returns&nbsp;some&nbsp;non-NULL&nbsp;value.&nbsp;&nbsp;Is&lt;br&gt;this&nbsp;a&nbsp;known&nbsp;bug&nbsp;or&nbsp;am&nbsp;I&nbsp;doing&nbsp;something&nbsp;wrong?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Kristen&nbsp;Eisenberg&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Billige&nbsp;Flüge&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Marketing&nbsp;GmbH&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Emanuelstr.&nbsp;3,&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;10317&nbsp;Berlin&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Deutschland&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Telefon:&nbsp;+49&nbsp;(33)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;5310967&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Email:&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;utebachmeier&nbsp;at&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gmail.com&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;Site:&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;lang=&quot;DE&quot;&gt;&lt;a&nbsp;href=&quot;http://flug.airego.de&quot;&nbsp;target=&quot;_blank&quot;&gt;http://flug.airego.de&lt;/a&gt;<br>
-&nbsp;Billige&nbsp;Flüge&nbsp;vergleichen&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
jemalloc-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:jemalloc-discuss@canonware.com&quot;&gt;jemalloc-discuss@canonware.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.canonware.com/mailman/listinfo/jemalloc-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.canonware.com/mailman/listinfo/jemalloc-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
