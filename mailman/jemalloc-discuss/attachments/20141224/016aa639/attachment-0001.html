<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;div&gt;I&#39;m&nbsp;trying&nbsp;to&nbsp;get&nbsp;the&nbsp;stat&nbsp;for&nbsp;total&nbsp;allocated&nbsp;memory.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;i&#39;m&nbsp;calling&nbsp;either:&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;size_t&nbsp;um;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;size_t&nbsp;sz&nbsp;=&nbsp;sizeof(size_t);&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;res&nbsp;=&nbsp;je_mallctl(&quot;stats.allocated&quot;,&nbsp;&amp;um,&nbsp;&amp;sz,&nbsp;NULL,&nbsp;0);&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;or &lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;size_t&nbsp;allocated_mib[2];&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;size_t&nbsp;allocated_mib_len&nbsp;=&nbsp;0;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;allocated_mib_len&nbsp;=&nbsp;sizeof(allocated_mib);&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;int&nbsp;res&nbsp;=&nbsp;je_mallctlnametomib(&quot;stats.allocated&quot;,&nbsp;allocated_mib,&nbsp;&amp;allocated_mib_len);&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;int&nbsp;res&nbsp;=&nbsp;je_mallctlbymib(allocated_mib,&nbsp;allocated_mib_len,&nbsp;&amp;um,&nbsp;&amp;sz,&nbsp;NULL,&nbsp;0);&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;both&nbsp;return&nbsp;success&nbsp;(0),&nbsp;but&nbsp;&#39;um&#39;&nbsp;variable&nbsp;is&nbsp;always&nbsp;set&nbsp;to&nbsp;0.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;digging&nbsp;into&nbsp;the&nbsp;source&nbsp;code&nbsp;of&nbsp;jemalloc,&nbsp;it&nbsp;seems&nbsp;that ctl_refresh()&nbsp;which&nbsp;is&nbsp;suppose&nbsp;to&nbsp;update&nbsp;this&nbsp;stat&nbsp;is&nbsp;never&nbsp;called.&lt;/div&gt;&lt;div&gt;p.s.&nbsp;config_stats&nbsp;is&nbsp;set&nbsp;to&nbsp;true,&nbsp;and&nbsp;i&nbsp;confirmed&nbsp;that&nbsp;with&nbsp;a&nbsp;debugger.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;is&nbsp;it&nbsp;a&nbsp;bug?&nbsp;or&nbsp;am&nbsp;i&nbsp;missing&nbsp;something?&lt;/div&gt;&lt;div&gt;thanks.&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;Oran.&lt;/div&gt;&lt;/div&gt;<br>

</tt>
