<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hi,&lt;br&gt;&lt;br&gt;&lt;/div&gt;I&nbsp;have&nbsp;been&nbsp;trying&nbsp;to&nbsp;use&nbsp;jemalloc&nbsp;for&nbsp;my&nbsp;application&nbsp;and&nbsp;observed&nbsp;that&nbsp;the&nbsp;rss&nbsp;of&nbsp;the&nbsp;process&nbsp;keeps&nbsp;on&nbsp;increasing.&lt;br&gt;&lt;br&gt;&lt;/div&gt;I&nbsp;ran&nbsp;the&nbsp;application&nbsp;with&nbsp;valgrind&nbsp;to&nbsp;confirm&nbsp;that&nbsp;there&nbsp;are&nbsp;no&nbsp;memory&nbsp;leaks.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;To&nbsp;investigate&nbsp;more,&nbsp;I&nbsp;collected&nbsp;jemalloc&nbsp;stats&nbsp;after&nbsp;running&nbsp;the&nbsp;test&nbsp;for&nbsp;few&nbsp;days&nbsp;and&nbsp;here&nbsp;is&nbsp;the&nbsp;summary&nbsp;for&nbsp;a&nbsp;run&nbsp;with&nbsp;narenas:1,&nbsp;tcache:false,&nbsp;lg_chunk:24&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt; Arenas:&nbsp;1&lt;br&gt; Pointer&nbsp;size:&nbsp;8&lt;br&gt;<br>
 Quantum&nbsp;size:&nbsp;16&lt;br&gt; Page&nbsp;size:&nbsp;4096&lt;br&gt; Min&nbsp;active:dirty&nbsp;page&nbsp;ratio&nbsp;per&nbsp;arena:&nbsp;8:1&lt;br&gt; Maximum&nbsp;thread-cached&nbsp;size&nbsp;class:&nbsp;32768&lt;br&gt; Chunk&nbsp;size:&nbsp;16777216&nbsp;(2^24)&lt;br&gt; Allocated:&nbsp;24364176040,&nbsp;active:&nbsp;24578334720,&nbsp;mapped:&nbsp;66739765248&lt;br&gt;<br>
 Current&nbsp;active&nbsp;ceiling:&nbsp;24578621440&lt;br&gt; chunks:&nbsp;nchunks  &nbsp;highchunks   &nbsp;curchunks&lt;br&gt;           &nbsp;3989        &nbsp;3978        &nbsp;3978&lt;br&gt; huge:&nbsp;nmalloc     &nbsp;ndalloc   &nbsp;allocated&lt;br&gt;            &nbsp;3           &nbsp;2   &nbsp;117440512&lt;br&gt; &lt;br&gt;<br>
 arenas[0]:&lt;br&gt; assigned&nbsp;threads:&nbsp;17&lt;br&gt; dss&nbsp;allocation&nbsp;precedence:&nbsp;disabled&lt;br&gt; dirty&nbsp;pages:&nbsp;5971898:64886&nbsp;active:dirty,&nbsp;354265&nbsp;sweeps,&nbsp;18261119&nbsp;madvises,&nbsp;1180858954&nbsp;purged&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;While&nbsp;in&nbsp;this&nbsp;state,&nbsp;the&nbsp;RSS&nbsp;of&nbsp;the&nbsp;process&nbsp;was&nbsp;at&nbsp;54GB.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;Questions:&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;The&nbsp;difference&nbsp;between&nbsp;RSS&nbsp;and&nbsp;jemalloc&nbsp;active&nbsp;is&nbsp;huge&nbsp;(more&nbsp;than&nbsp;30GB).&nbsp;In&nbsp;my&nbsp;test,&nbsp;the&nbsp;difference&nbsp;was&nbsp;quite&nbsp;less&nbsp;in&nbsp;the&nbsp;beginning&nbsp;(say&nbsp;4&nbsp;GB)&nbsp;and&nbsp;it&nbsp;went&nbsp;on&nbsp;increasing&nbsp;with&nbsp;time.&nbsp;That&nbsp;seems&nbsp;too&nbsp;high&nbsp;to&nbsp;account&nbsp;for&nbsp;jemalloc&nbsp;data&nbsp;structures,&nbsp;overhead&nbsp;etc.&nbsp;What&nbsp;else&nbsp;gets&nbsp;accounted&nbsp;in&nbsp;process&nbsp;RSS&nbsp;-&nbsp;active?&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;2)&nbsp;The&nbsp;allocations&nbsp;are&nbsp;fairly&nbsp;random,&nbsp;sized&nbsp;between&nbsp;8&nbsp;bytes&nbsp;and&nbsp;2MB.&nbsp;Are&nbsp;there&nbsp;any&nbsp;known&nbsp;issues&nbsp;of&nbsp;fragmentation&nbsp;for&nbsp;particular&nbsp;allocation&nbsp;sizes?&lt;br&gt;&lt;/div&gt;&lt;div&gt;3)&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;tune&nbsp;the&nbsp;allocations&nbsp;and&nbsp;reduce&nbsp;the&nbsp;difference?&nbsp;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Will&nbsp;appreciate&nbsp;any&nbsp;help&nbsp;to&nbsp;understand&nbsp;this&nbsp;better,&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;br&gt;&lt;/div&gt;&lt;div&gt;Vandana&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
