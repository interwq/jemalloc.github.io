<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> problem with the arenas_tsd key
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20problem%20with%20the%20arenas_tsd%20key&In-Reply-To=%3CCAL5sXW7yX1WN%2BjFKKea4oisW%3D%2B9ak1O%2BZjnncSjwc_qE0ZFxWg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000040.html">
   <LINK REL="Next"  HREF="000041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>problem with the arenas_tsd key</H1>
    <B>Rich Prohaska</B> 
    <A HREF="mailto:jemalloc-discuss%40canonware.com?Subject=Re%3A%20problem%20with%20the%20arenas_tsd%20key&In-Reply-To=%3CCAL5sXW7yX1WN%2BjFKKea4oisW%3D%2B9ak1O%2BZjnncSjwc_qE0ZFxWg%40mail.gmail.com%3E"
       TITLE="problem with the arenas_tsd key">prohaska at tokutek.com
       </A><BR>
    <I>Tue Oct 18 13:49:21 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000040.html">Updated jemalloc-packages for Red Hat and Fedora (Was: jemalloc	2.2.3 released)
</A></li>
        <LI>Next message: <A HREF="000041.html">jemalloc git server down for a few days now
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45">[ date ]</a>
              <a href="thread.html#45">[ thread ]</a>
              <a href="subject.html#45">[ subject ]</a>
              <a href="author.html#45">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The value associated with arenas_tsd is set before the key is created.  This
can corrupt some other library that is using key 0.  Attached is a program
that demonstrates the problem and a proposed fix to the problem.  We are not
experts on jemalloc internals, and we would appreciate any feedback about
the fix.

Run &quot;make check_arena_key&quot; to reproduce the crash.

See jemalloc.c for the fix.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment.html">http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_arena_key.c
Type: text/x-csrc
Size: 683 bytes
Desc: not available
URL: &lt;<A HREF="http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment.c">http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment.c</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Makefile
Type: application/octet-stream
Size: 552 bytes
Desc: not available
URL: &lt;<A HREF="http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment.obj">http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment.obj</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: jemalloc.c
Type: text/x-csrc
Size: 41018 bytes
Desc: not available
URL: &lt;<A HREF="http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment-0001.c">http://jemalloc.net/mailman/jemalloc-discuss/attachments/20111018/1ce797c6/attachment-0001.c</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000040.html">Updated jemalloc-packages for Red Hat and Fedora (Was: jemalloc	2.2.3 released)
</A></li>
	<LI>Next message: <A HREF="000041.html">jemalloc git server down for a few days now
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45">[ date ]</a>
              <a href="thread.html#45">[ thread ]</a>
              <a href="subject.html#45">[ subject ]</a>
              <a href="author.html#45">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.canonware.com/mailman/listinfo/jemalloc-discuss">More information about the jemalloc-discuss
mailing list</a><br>
</body></html>
